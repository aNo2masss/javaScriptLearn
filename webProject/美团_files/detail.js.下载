STK.register("kit.dom.parseDOM",function(a){return function(c){for(var b in c){if(c[b]&&(c[b].length==1)){c[b]=c[b][0]}}return c}});STK.register("kit.extra.language",function(a){window.$LANG||(window.$LANG={});return function(b){var d=[].splice.call(arguments,1,arguments.length);var c=[b,$LANG].concat(d);var e=a.core.util.language.apply(this,c);return e}});STK.register("comp.app.desc",function(e){var d=e.core.evt.addEvent,b=e.core.dom.addClassName,g=e.core.dom.removeClassName,c=e.kit.extra.language,a=c("#L{收起}"),f=c("#L{展开}");return function(l,u){var o,m,r,t,j,p='<a class="detail_more" node-type="unfold" href="javascript:void(0)">'+f+'</a><a class="icon_down icon_state" node-type="arrow" href="javascript:;"></a>';conf=e.parseParam({height:65,count:"150"},u);var s=function(){if(!l){throw"node is not defined"}};var i=function(){j=e.kit.dom.parseDOM(e.core.dom.builder(l).list);r=j.desc;if(!r){throw"can not find nodes"}};var q=function(){};var h={init:function(){m=e.core.ani.tween(r);t=r.innerHTML;var w=e.core.str.bLength(t);if(w>=conf.count){h.insert();h.fold()}},insert:function(w){w=w?true:false;var x=w?t:e.core.str.leftB(t,conf.count)+"...";r.innerHTML=x;o=e.core.dom.builder(p);r.appendChild(o.box);h.addEvent()},fold:function(){this.aDom.innerHTML=f;g(this.arrow,"icon_up");b(this.arrow,"icon_down")},unfold:function(){this.aDom.innerHTML=a;var w=r.offsetHeight+r.scrollHeight;g(this.arrow,"icon_down");b(this.arrow,"icon_up")},addEvent:function(){var w=this.aDom=o.list.unfold[0];this.arrow=o.list.arrow[0];d(w,"click",function(){if(w.innerHTML===f){h.insert(1);h.unfold()}else{h.insert();h.fold()}});d(this.arrow,"click",function(){if(w.innerHTML===f){h.insert(1);h.unfold()}else{h.insert();h.fold()}})}};var n=function(){h.init()};var v=function(){s();i();q();n()};v()}});STK.pageletM.register("pl.app.desc",function(b){var a=b.E("pl_app_desc");var c=b.comp.app.desc(a)});STK.register("kit.extra.merge",function(a){return function(d,c){var f={};for(var e in d){f[e]=d[e]}for(var e in c){f[e]=c[e]}return f}});STK.register("kit.io.ajax",function(a){return function(i){var h,f,e,g,j,b,c;b=function(m){j=false;i.onComplete(m,h.args);setTimeout(l,0)};c=function(m){j=false;i.onFail(m,h.args);setTimeout(l,0)};e=[];g=null;j=false;h=a.parseParam({url:"",method:"get",responseType:"json",timeout:30*1000,onTraning:a.funcEmpty,isEncode:true},i);h.onComplete=b;h.onFail=c;var l=function(){if(!e.length){return}if(j===true){return}j=true;h.args=e.shift();g=a.ajax(h)};var d=function(n){while(e.length){e.shift()}j=false;if(g){try{g.abort()}catch(m){}}g=null};f={};f.request=function(m){if(!m){m={}}if(i.noQueue){d()}if(!i.uniqueRequest||!g){e.push(m);m._t=0;l()}};f.abort=d;return f}});STK.register("kit.io.jsonp",function(a){return function(d){var c,f,b,h,e;c=a.parseParam({url:"",method:"get",responseType:"json",varkey:"_v",timeout:30*1000,onComplete:a.funcEmpty,onTraning:a.funcEmpty,onFail:a.funcEmpty,isEncode:true},d);b=[];h={};e=false;var g=function(){if(!b.length){return}if(e===true){return}e=true;h.args=b.shift();h.onComplete=function(i){e=false;c.onComplete(i,h.args);setTimeout(g,0)};h.onFail=function(i){e=false;c.onFail(i);setTimeout(g,0)};a.jsonp(a.kit.extra.merge(c,{args:h.args,onComplete:function(i){h.onComplete(i)},onFail:function(i){try{h.onFail(i)}catch(j){}}}))};f={};f.request=function(i){if(!i){i={}}b.push(i);i._t=1;g()};f.abort=function(i){while(b.length){b.shift()}e=false;h=null};return f}});STK.register("kit.io.inter",function(a){return function(){var b,d,c;b={};d={};c={};b.register=function(f,e){if(d[f]!==undefined){throw f+" interface has been registered"}d[f]=e;c[f]={}};b.hookComplete=function(e,g){var f=a.core.util.getUniqueKey();c[e][f]=g;return f};b.removeHook=function(e,f){if(c[e]&&c[e][f]){delete c[e][f]}};b.getTrans=function(g,e){var f=a.kit.extra.merge(d[g],e);f.onComplete=function(i,l){try{e.onComplete(i,l)}catch(j){}if(i.code==="100000"||i.code==="A00006"){try{e.onSuccess(i,l)}catch(j){}}else{try{if(i.code==="100002"){window.location.href=i.data;return}e.onError(i,l)}catch(j){}}for(var h in c[g]){try{c[g][h](i,l)}catch(j){}}};if(d[g]["requestMode"]==="jsonp"){return a.kit.io.jsonp(f)}else{if(d[g]["requestMode"]==="ijax"){return a.kit.io.ijax(f)}else{return a.kit.io.ajax(f)}}};b.request=function(h,e,g){var f=a.core.json.merge(d[h],e);f.onComplete=function(j,m){try{e.onComplete(j,m)}catch(l){}if(j.code==="100000"||j.code==="A00006"){try{e.onSuccess(j,m)}catch(l){}}else{try{if(j.code==="100002"){window.location.href=j.data;return}e.onError(j,m)}catch(l){}}for(var i in c[h]){try{c[h][i](j,m)}catch(l){}}};f=a.core.obj.cut(f,["noqueue"]);f.args=g;if(d[h]["requestMode"]==="jsonp"){return a.jsonp(f)}else{if(d[h]["requestMode"]==="ijax"){return a.ijax(f)}else{return a.ajax(f)}}};return b}});STK.register("common.trans.app",function(e){var b=e.kit.io.inter();var d=b.register,c=location.host,a=(c=="app.weibo.com"?"":"/app");if(c=="app.weibo.com"){d("follow",{url:"/aj_follow.php",method:"post"})}else{d("follow",{url:"/aj/f/followed",method:"post"})}d("card",{url:a+"/aj_app_card.php",method:"post"});if(c=="app.weibo.com"){d("grade",{url:a+"/aj_setscore.php",method:"post"})}else{d("grade",{url:"/aj_scoremb.php",method:"post"})}d("comment",{url:a+"/aj_relatmb.php",method:"get"});d("user",{url:a+"/aj_relateduser.php",method:"get"});d("revoke",{url:a+"/aj_app_revoke.php",method:"post"});d("suggest",{url:a+"/aj_app_suggest.php",method:"post"});d("play",{url:a+"/aj_change_fplay.php",method:"get"});d("checkin",{url:a+"/aj_checkin.php",method:"post"});d("task",{url:a+"/aj_task.php",method:"get"});d("sale",{url:a+"/aj_sale.php",method:"get"});d("pub",{url:a+"/aj_pubweibo.php",method:"post"});d("intro",{url:a+"/aj_getperfect.php",method:"get"});d("action",{url:a+"/aj_turnaction.php",method:"post"});d("privacy",{url:a+"/aj_setprivacy.php",method:"post"});d("appUserList",{url:"/aj_getappfriends.php",method:"post"});d("appshow",{url:a+"/aj_gethotrec.php",method:"get"});d("myapps",{url:a+"/aj_getmyapps.php",method:"get"});d("like",{url:a+"/aj_guessyoulike.php",method:"post"});d("friend",{url:a+"/aj_getappfriends.php",method:"post"});d("more",{url:a+"/aj_detailext.php",method:"get"});d("android",{url:a+"/aj_pushmessage.php",method:"get"});d("userCardFollow",{url:"/aj_pub_follow_add.php",method:"post"});d("userCard",{url:"/aj_pub_ucard.php",method:"get"});d("getRemark",{url:"/aj_pub_remark_get.php",method:"get"});d("remark",{url:"/aj_pub_remark_update.php",method:"post"});d("addGroup",{url:"/aj_pub_follow_group_add.php",method:"post"});d("setGroup",{url:"/aj_pub_group_add_user.php",method:"post"});d("cancelFollowed",{url:"/aj_pub_follow_cancel.php",method:"post"});d("group_info",{url:"/aj_pub_group_info.php",method:"get"});d("addPics",{url:"/aj_flowadd.php",method:"post"});d("removePics",{url:"/aj_flowdel.php",method:"post"});return b});STK.register("common.login.getLoginStatus",function(d){function a(){var h="";var g=false;if($CONFIG&&$CONFIG.islogin=="0"){g=false}else{if($CONFIG&&$CONFIG.islogin=="1"){g=true}else{var f=document.cookie+";";var j=["SUP","=([^;]*)?;"].join("");var e=["(\\?|&)","uid","=([^&]*)(&|$)"].join("");var i=f.match(new RegExp(j,"i"));i=(i)?i[1]||"":"";i=unescape(i);h=i.match(new RegExp(e));h=(h)?h[2]||"":"";g=!!h}}return{uid:h,isLogin:g}}function c(){return a().uid}function b(){return a().isLogin}return{uid:c,isLogin:b}});STK.register("common.login.showLogin",function(a){return function(b){var c=a.parseParam({url:encodeURIComponent(document.location.href)},b);if(typeof window.WBtopPublic=="object"){WBtopPublic.showLoginLayer({loginSuccessUrl:c.url})}}});STK.register("common.app.grade",function(d){var c=d.core.evt.addEvent,b=d.kit.extra.language,a=[b("#L{很差}"),b("#L{不好用}"),b("#L{还行}"),b("#L{很好}"),b("#L{十分完美}")];return function(i,r){if(!i){throw"common.grade need node for mark"}var g=window.$CONFIG||{$score:0,$appId:""};var m={score:g.$score||0};var n,e,f,q=false;f=d.custEvent.define(m,"mark");n=d.parseParam({score:g.$score||0,tag:"b",bmsg:b("#L{(未评分)}"),desc:b("#L{您已评分}"),handler:"",starWidth:12},r);var l=function(){e=d.kit.dom.parseDOM(d.core.dom.builder(i).list)};var j=function(){var t=d.sizzle(n.tag,i);if(t&&t.length){d.core.arr.foreach(t,function(u,v){var w=parseInt(v+1);c(u,"mouseover",function(){h(w,a[v],"over")});c(u,"click",function(){if(!d.common.login.getLoginStatus.isLogin()){d.common.login.showLogin();return}o(w);h(w,a[v],"click")})})}c(i,"mouseout",function(){var u=p();h(u,"&nbsp;","out")})};var h=function(t,w,u){w=w||a[t-1];var v=parseInt(t,10);e.star.style.width=v*n.starWidth+"px";if(e.desc){if(n.handler=="publisher"){if(u=="click"){}else{if(u=="out"){if(v==0){w=n.bmsg}else{w=n.desc}}}}else{if(u=="out"){if(v==0){w=""}else{w=a[m.score-1]}}}e.desc.innerHTML=w}if(e.score){e.score.innerHTML=v+".0"}};var o=function(u){if(q){return}q=true;g.$score=m.score=parseInt(u,10);var t=d.common.trans.app.getTrans("grade",{onComplete:function(v,w){q=false;if(v.code=="100000"||v.code=="A00006"){d.custEvent.fire(f,"mark",{score:u,desc:a[parseInt((u-1),10)]})}else{d.ui.alert(v.msg)}},onFail:function(){q=false;d.ui.alert(b("#L{请求错误}"))}});t.request({id:g.$appId,score:u,type:"score"})};var p=function(){if(n.handler=="publisher"){return parseInt(g.$score||m.score||n.score)}return parseInt(m.score||(g.$score||0))};var s=function(){l();j()};s();return m}});STK.register("kit.extra.textareaUtils",function(c){var a={},b=document.selection;a.selectionStart=function(e){if(!b){return e.selectionStart}var i=b.createRange(),h,d,g=0;var f=document.body.createTextRange();f.moveToElementText(e);for(g;f.compareEndPoints("StartToStart",i)<0;g++){f.moveStart("character",1)}return g};a.selectionBefore=function(d){return d.value.slice(0,a.selectionStart(d))};a.selectText=function(d,e,f){d.focus();if(!b){d.setSelectionRange(e,f);return}var g=d.createTextRange();g.collapse(1);g.moveStart("character",e);g.moveEnd("character",f-e);g.select()};a.insertText=function(f,e,h,g){f.focus();g=g||0;if(!b){var i=f.value,l=h-g,d=l+e.length;f.value=i.slice(0,l)+e+i.slice(h,i.length);a.selectText(f,d,d);return}var j=b.createRange();j.moveStart("character",-g);j.text=e};a.replaceText=function(g,e){g.focus();var h=g.value;var l=a.getSelectedText(g);var f=l.length;if(l.length==0){a.insertText(g,e,a.getCursorPos(g))}else{var j=a.getCursorPos(g);if(b){var i=b.createRange();i.text=e;a.setCursor(g,j+e.length)}else{var d=j+l.length;g.value=h.slice(0,j)+e+h.slice(j+f,h.length);a.setCursor(g,j+e.length);return}}};a.getCursorPos=function(g){var f=0;if(STK.core.util.browser.IE){g.focus();var d=null;d=b.createRange();var e=d.duplicate();e.moveToElementText(g);e.setEndPoint("EndToEnd",d);g.selectionStart=e.text.length-d.text.length;g.selectionEnd=g.selectionStart+d.text.length;f=g.selectionStart}else{if(g.selectionStart||g.selectionStart=="0"){f=g.selectionStart}}return f};a.getSelectedText=function(e){var f="";var d=function(g){if(g.selectionStart!=undefined&&g.selectionEnd!=undefined){return g.value.substring(g.selectionStart,g.selectionEnd)}else{return""}};if(window.getSelection){f=d(e)}else{f=b.createRange().text}return f};a.setCursor=function(f,g,e){g=g==null?f.value.length:g;e=e==null?0:e;f.focus();if(f.createTextRange){var d=f.createTextRange();d.move("character",g);d.moveEnd("character",e);d.select()}else{f.setSelectionRange(g,g+e)}};a.unCoverInsertText=function(g,i,f){f=(f==null)?{}:f;f.rcs=f.rcs==null?g.value.length:f.rcs*1;f.rccl=f.rccl==null?0:f.rccl*1;var h=g.value,d=h.slice(0,f.rcs),e=h.slice(f.rcs+f.rccl,h==""?0:h.length);g.value=d+i+e;this.setCursor(g,f.rcs+(i==null?0:i.length))};return a});STK.register("kit.extra.count",function(b){function a(l){var e=41,n=140,c=20,f=l;var m=l.match(/http:\/\/[a-zA-Z0-9]+(\.[a-zA-Z0-9]+)+([-A-Z0-9a-z_\$\.\+\!\*\(\)\/,:;@&=\?\~\#\%]*)*/gi)||[];var d=0;for(var g=0,j=m.length;g<j;g++){var h=b.core.str.bLength(m[g]);if(/^(http:\/\/t.cn)/.test(m[g])){continue}else{if(/^(http:\/\/)+(t.sina.com.cn|t.sina.cn)/.test(m[g])||/^(http:\/\/)+(weibo.com|weibo.cn)/.test(m[g])){d+=h<=e?h:(h<=n?c:(h-n+c))}else{d+=h<=n?c:(h-n+c)}}f=f.replace(m[g],"")}var o=Math.ceil((d+b.core.str.bLength(f))/2);return o}return function(c){c=c.replace(/\r\n/g,"\n");return num=a(c)}});STK.register("module.editor",function(e){var c=e.core.evt.addEvent;var b=e.core.evt.custEvent;var a=e.core.dom.getStyle;var d=e.core.dom.setStyle;return function(v,m){var o={};var m=m;var u={};var l={reset:function(){u.textEl.value="";e.core.evt.custEvent.fire(o,"changed");u.textEl.removeAttribute("extra")},delWords:function(A){var z=l.getWords();if(z.indexOf(A)>-1){u.textEl.value="";x.textInput(z.replace(A,""))}else{return false}},getWords:function(){return e.core.str.trim(u.textEl.value)},getExtra:function(){var A;var z=u.textEl.getAttribute("extra")||"";if(z!=null){A=e.core.str.trim(z)}return A},focus:function(B,z){if(typeof B!="undefined"){e.kit.extra.textareaUtils.setCursor(u.textEl,B,z)}else{var A=u.textEl.value.length;e.kit.extra.textareaUtils.setCursor(u.textEl,A)}},blur:function(){u.textEl.blur()},addExtraInfo:function(z){if(typeof z=="string"){u.textEl.setAttribute("extra",z)}},disableEditor:function(z){if(z===true){u.textEl.setAttribute("disabled","disabled")}else{u.textEl.removeAttribute("disabled")}},getCurPos:function(){var z=u.textEl.getAttribute("range")||"0&0";return z.split("&")},count:function(){var z=(e.core.str.trim(u.textEl.value).length==0)?e.core.str.trim(u.textEl.value):u.textEl.value;return e.kit.extra.count(z)}};var f={textElFocus:function(){if(u.recommendTopic){e.core.dom.setStyle(u.recommendTopic,"display","none")}e.custEvent.fire(o,"focus");if(u.num){e.core.dom.setStyle(u.num,"display","block")}if(l.getWords()==m.tipText){l.delWords(m.tipText)}},textElBlur:function(){setTimeout(function(){if(u.textEl.value.length===0){if(u.recommendTopic){e.core.dom.setStyle(u.recommendTopic,"display","block")}if(u.num&&u.recommendTopic){e.core.dom.setStyle(u.num,"display","none")}e.custEvent.fire(o,"blur");if(typeof m.tipText!="undefined"){u.textEl.value=m.tipText}}},50)},cacheCurPos:function(){var A=e.kit.extra.textareaUtils.getSelectedText(u.textEl);var B=(A==""||A==null)?0:A.length;var C=e.kit.extra.textareaUtils.getCursorPos(u.textEl);var z=C+"&"+B;u.textEl.setAttribute("range",z)}};var x={textChanged:function(){e.custEvent.fire(o,"keyUpCount")},textInput:function(A,C){var B=l.getCurPos();var C=B[0];var z=B[1];if(l.getWords()==m.tipText&&A!=m.tipText){l.delWords(m.tipText)}e.kit.extra.textareaUtils.unCoverInsertText(u.textEl,A,{rcs:B[0],rccl:B[1]});f.cacheCurPos();e.core.evt.custEvent.fire(o,"changed")}};var r={};var g=function(){t();h()};var w=function(){n();p();q();i()};var i=function(){if(m.storeWords){if(u.textEl.value.length==0){x.textInput(m.storeWords)}return}if(m.tipText){u.textEl.value=m.tipText}};var t=function(){if(!v){throw"node is not defined in module editor"}};var h=function(){var z=e.core.dom.builder(v).list;u=e.kit.dom.parseDOM(z);if(!u.widget){throw"can not find nodes.widget in module editor"}};var n=function(){e.core.evt.addEvent(u.textEl,"focus",f.textElFocus);e.core.evt.addEvent(u.textEl,"blur",f.textElBlur);e.core.evt.addEvent(u.textEl,"mouseup",f.cacheCurPos);e.core.evt.addEvent(u.textEl,"keyup",f.cacheCurPos)};var j=function(){e.core.evt.custEvent.define(o,"changed")};var p=function(){j();e.core.evt.custEvent.add(o,"changed",x.textChanged)};var q=function(){};var y=function(){};g();var s={reset:l.reset,getWords:l.getWords,getExtra:l.getExtra,delWords:l.delWords,focus:l.focus,blur:l.blur,insertText:x.textInput,check:x.textChanged,addExtraInfo:l.addExtraInfo,disableEditor:l.disableEditor,getCurPos:l.getCurPos,count:l.count};o.destroy=y;o.API=s;o.nodeList=u;o.init=w;o.opts=m;return o}});STK.register("common.editor.plugin.count",function(e){var b;function d(o){var h=41,q=140,f=20,j=o;var p=o.match(/(http|https):\/\/[a-zA-Z0-9]+(\.[a-zA-Z0-9]+)+([-A-Z0-9a-z_\$\.\+\!\*\(\)\/\,\:;@&=\?~#%]*)*/gi)||[];var g=0;for(var l=0,n=p.length;l<n;l++){var m=e.core.str.bLength(p[l]);if(/^(http:\/\/t.cn)/.test(p[l])){continue}else{if(/^(http:\/\/)+(t.sina.com.cn|t.sina.cn)/.test(p[l])||/^(http:\/\/)+(weibo.com|weibo.cn)/.test(p[l])){g+=m<=h?m:(m<=q?f:(m-q+f))}else{g+=m<=q?f:(m-q+f)}}j=j.replace(p[l],"")}var r=Math.ceil((g+e.core.str.bLength(j))/2);return r}function a(i){var h=d(i);var g=Math.abs(b-h);var f;if(h>b||h<1){f={wordsnum:h,vnum:g,overflow:true}}else{if(h==0){f={wordsnum:h,vnum:g,overflow:true}}else{f={wordsnum:h,vnum:g,overflow:false}}}return f}function c(f,g){if(!f.textEl){throw"[editor plugin count]: plz check nodeList"}}return function(i){var f=i.nodeList;var g;var m=i.opts;var l=e.kit.extra.language;b=m.limitNum;c(f);e.core.evt.custEvent.define(i,"textNum");e.custEvent.define(i,"keyUpCount");var n=f.textEl;var h=f.num;e.addEvent(n,"focus",function(){g=setInterval(function(){j()},200)});e.addEvent(n,"blur",function(){clearInterval(g)});var j=function(){var p=(e.core.str.trim(n.value).length==0)?e.core.str.trim(n.value):n.value;p=p.replace(/\r\n/g,"\n");var o=a(p,m.limitNum);if(p.length>=0&&n.focus){if(o.overflow&&o.wordsnum!=0){h.innerHTML=l("#L{已经超过}")+'<span class="W_error"> '+o.vnum+"</span> "+l("#L{字}")}else{h.innerHTML=l("#L{还可以输入}<span>"+o.vnum+"</span> #L{字}")}}else{if(p.length===0){h.innerHTML="还可以输入<span>"+o.vnum+"</span> 字"}}e.core.evt.custEvent.fire(i,"textNum",{count:o.wordsnum,isOver:o.overflow})};STK.core.evt.addEvent(n,"keyup",j);e.custEvent.add(i,"keyUpCount",j)}});STK.register("kit.dom.cssText",function(b){var a=function(f,e){var c=(f+";"+e).replace(/(\s*(;)\s*)|(\s*(:)\s*)/g,"$2$4"),d;while(c&&(d=c.match(/(^|;)([\w\-]+:)([^;]*);(.*;)?\2/i))){c=c.replace(d[1]+d[2]+d[3],"")}return c};return function(d){d=d||"";var e=[],c={push:function(g,f){e.push(g+":"+f);return c},remove:function(g){for(var f=0;f<e.length;f++){if(e[f].indexOf(g+":")==0){e.splice(f,1)}}return c},getStyleList:function(){return e.slice()},getCss:function(){return a(d,e.join(";"))}};return c}});STK.register("common.listener",function(b){var c={};var a={};a.define=function(e,f){if(c[e]!=null){throw"common.listener.define: 频道已被占用"}c[e]=f;var d={};d.register=function(h,g){if(c[e]==null){throw"common.listener.define: 频道未定义"}b.listener.register(e,h,g)};d.fire=function(g,h){if(c[e]==null){throw"commonlistener.define: 频道未定义"}b.listener.fire(e,g,h)};d.remove=function(h,g){b.listener.remove(e,h,g)};d.cache=function(g){return b.listener.cache(e,g)};return d};return a});STK.register("module.at",function(g){var p=window,j=document,m=g.core.util.browser,b="font-family:Tahoma,宋体;",o=g.kit.extra.textareaUtils.selectionStart;var q;var c,h,e,l;var f=(function(){var d={"<":"&lt;",">":"&gt;",'"':"&quot;","\\":"&#92;","&":"&amp;","'":"&#039;","\r":"","\n":"<br>"," ":(navigator.userAgent.match(/.+(?:ie) ([\d.]+)/i)||[8])[1]<8?['<pre style="overflow:hidden;display:inline;',b,'word-wrap:break-word;"> </pre>'].join(""):['<span style="white-space:pre-wrap;',b,'"> </span>'].join("")};return function(s){var r=s.replace(/(<|>|\"|\\|&|\'|\n|\r| )/g,function(t){return d[t]});return r}})();var a=function(){var d=[],s=q.textEl.style.cssText,r;g.foreach(["margin","padding","border"],function(t){g.foreach(["Top","Left","Bottom","Right"],function(v){var u;if(t!="border"){u=d.push(t,"-",v.toLowerCase(),":",g.getStyle(q.textEl,t+v),";");return}g.foreach(["Color","Style","Width"],function(w){d.push(t,"-",v.toLowerCase(),"-",w.toLowerCase(),":",g.getStyle(q.textEl,[t,v,w].join("")),";")})})});d.push("font-size:"+g.getStyle(q.textEl,"fontSize")+";");return g.kit.dom.cssText([s,d.join(""),b,"			word-wrap: break-word;			line-height: 18px;			overflow-y:auto;			overflow-x:hidden;			outline:none;		"].join("")).getCss()};var n=(function(){var w=g.builder(['<div node-type="wrap" style="display:none;">','<span node-type="before"></span>','<span node-type="flag"></span>','<span node-type="after"></span>',"</div>"].join("")).list;var r=w.wrap[0],x=w.flag[0],d=w.after[0],z=w.before[0],v=0,t,s,y;var u=function(A){if(m.MOZ){return -2}if(m.MOBILE&&m.SAFARI&&(m.IPAD||m.ITOUCH||m.IPHONE)){return -2}return 0};return{bind:function(){if(s===q.textEl){return}l=g.position(q.textEl);var A=["left:",l.l,"px;top:",l.t+20,"px;"].join("");s=q.textEl;var B=a();s.style.cssText=B;y=[A,B,"					position:absolute;					filter:alpha(opacity=0);					opacity:0;					z-index:-1000;				"].join("");r.style.cssText=y;if(!v){v=1;j.body.appendChild(r)}},content:function(A,C,D,B){r.style.cssText=[y,"					width:",((parseInt(g.getStyle(s,"width"))||s.offsetWidth)+u()),"px;					height:",((parseInt(g.getStyle(s,"height"))||s.offsetHeight)),"px;					overflow-x:hidden;					overflow-y:",(/webkit/i.test(navigator.userAgent))?"hidden":g.getStyle(s,"overflowY"),";				"].join("");z.innerHTML=f(A);x.innerHTML=f(C)||"&thinsp;";d.innerHTML=f([D,B].join(""));clearTimeout(t);t=setTimeout(function(){var E=g.position(x);g.custEvent.fire(q.eId,"at",{t:(E.t-s.scrollTop)-l.t,l:E.l-l.l,fl:E.l,key:D,flag:C,textarea:q.textEl})},30)},hide:function(){r.style.display="none"},show:function(){r.style.display=""}}})();var i=function(){var d=q.textEl.value.replace(/\r/g,"");var u=o(q.textEl);if(u<0||u==e){return}e=u;var s=d.slice(0,u);var r=s.match(new RegExp(["(",q.flag,")([a-zA-Z0-9\u4e00-\u9fa5_]{0,20})$"].join("")));if(!r){g.custEvent.fire(q.eId,"hidden");return}var t=d.slice(u);s=s.slice(0,-r[0].length);n.content(s,r[1],r[2],t)};return function(r){if(!r||!r.textEl){return}r=g.parseParam({textEl:null,flag:"@",eId:g.custEvent.define({},["at","hidden"])},r);var s=function(){clearInterval(c);g.removeEvent(r.textEl,"blur",s);n.hide()};var d=function(){s();q=r;e=null;n.bind();n.show();c=setInterval(i,200);g.addEvent(r.textEl,"blur",s)};g.addEvent(r.textEl,"focus",d);return r.eId}});STK.register("common.trans.at",function(c){var a=c.kit.io.inter();var b=a.register;b("followList",{url:"/aj_attention.php"});b("topicList",{url:"/aj/mblog/topic?_wv=5"});return a});STK.register("module.suggest",function(j){var h=null,e=j.custEvent,m=e.define,f=e.fire,p=e.add,g=j.addEvent,c=j.removeEvent,o=j.stopEvent;var b=[],a={};var i={ENTER:13,ESC:27,UP:38,DOWN:40,TAB:9};var l=function(w){var v=-1,t=[],r=w.textNode,s=w.uiNode;var A=j.core.evt.delegatedEvent(s);var q=m(r,["open","close","indexChange","onSelect","onIndexChange","onClose","onOpen"]);var y=function(){return j.sizzle(["[action-type=",w.actionType,"]"].join(""),s)};var z=function(){v=-1;c(r,"keydown",u);A.destroy()};var u=function(D){var E,C;if(!(E=D)||!(C=E.keyCode)){return}if(C==i.ENTER||C==i.TAB){o();f(q,"onSelect",[v,r]);return false}if(C==i.UP){o();var B=y().length;v=v<1?B-1:v-1;f(q,"onIndexChange",[v]);return false}if(C==i.DOWN){o();var B=y().length;v=v==(B-1)?0:v+1;f(q,"onIndexChange",[v]);return false}if(C==i.ESC){o();z();f(q,"onClose");return false}};var x=function(B){f(q,"onSelect",[j.core.arr.indexOf(B.el,y()),r])};var n=function(B){v=j.core.arr.indexOf(B.el,y());f(q,"onIndexChange",[j.core.arr.indexOf(B.el,y())])};p(q,"open",function(C,B){r=B;z();g(B,"keydown",u);A.add(w.actionType,"mouseover",n);A.add(w.actionType,"click",x);f(q,"onOpen")});p(q,"close",function(){z();f(q,"onClose")});p(q,"indexChange",function(B,C){v=C;f(q,"onIndexChange",[v])});return q};var d=function(n){var q=n.textNode;var r=j.core.arr.indexOf(q,b);if(!a[r]){b[r=b.length]=q;a[r]=l(n)}return a[r]};return function(n){if(!n.textNode||!n.uiNode){return}n=j.parseParam({textNode:h,uiNode:h,actionType:"item",actionData:"index"},n);return ins=d(n)}});STK.register("kit.dom.layoutPos",function(a){return function(e,c,b){if(!a.isNode(c)){throw"kit.dom.layerOutElement need element as first parameter"}if(c===document.body){return false}if(!c.parentNode){return false}if(c.style.display==="none"){return false}var g,f,i,l,h,j,d;g=a.parseParam({pos:"left-bottom",offsetX:0,offsetY:0},b);f=c;if(!f){return false}while(f!==document.body){f=f.parentNode;if(f.style.display==="none"){return false}j=a.getStyle(f,"position");d=f.getAttribute("layout-shell");if(j==="absolute"||j==="fixed"){break}if(d==="true"&&j==="relative"){break}}f.appendChild(e);i=a.position(c,{parent:f});l={w:c.offsetWidth,h:c.offsetHeight};h=g.pos.split("-");if(h[0]==="left"){e.style.left=i.l+g.offsetX+"px"}else{if(h[0]==="right"){e.style.left=i.l+l.w+g.offsetX+"px"}else{if(h[0]==="center"){e.style.left=i.l+l.w/2+g.offsetX+"px"}}}if(h[1]==="top"){e.style.top=i.t+g.offsetY+"px"}else{if(h[1]==="bottom"){e.style.top=i.t+l.h+g.offsetY+"px"}else{if(h[1]==="middle"){e.style.top=i.t+l.h/2+g.offsetY+"px"}}}return true}});STK.register("common.channel.at",function(b){var a=["open","close"];return b.common.listener.define("common.channel.at",a)});STK.register("common.editor.plugin.at",function(e){var l='<div style="" class="layer_menu_list"><ul node-type="suggestWrap"></ul></div>';var n='<#et temp data><li class="suggest_title">想用@提到谁？</li><#list data as list><li action-type="item" <#if (list_index == 0)>class="cur" </#if>action-data="value=${list.nickname}" value="${list.nickname}"><a href="#">${list.nickname}</a></li></#list></#et>';var g,j,t,c,p,u,i=false,m;var s;var d=0;var h=function(){setTimeout(function(){e.custEvent.fire(g,"close")},200)};var a=function(){p.style.display="none"};var o=function(){e.custEvent.add(g,"onIndexChange",function(x,w){q(w)});e.custEvent.add(g,"onSelect",function(z,y,x){e.core.evt.stopEvent();var B=s[y].getAttribute("value");var w=u.length*1;var A=e.kit.extra.textareaUtils.selectionStart(x)*1;e.kit.extra.textareaUtils.insertText(x,B+" ",A,w);e.custEvent.fire(g,"close")});e.addEvent(t.textEl,"blur",h);e.custEvent.add(g,"onClose",a);e.custEvent.add(g,"onOpen",function(x,w){c.style.display="";p.style.display="";i=true;setTimeout(function(){e.custEvent.fire(g,"indexChange",0)},100)})};var v=function(){STK.core.evt.custEvent.add(j,"hidden",function(w,x){e.custEvent.fire(g,"close")});STK.core.evt.custEvent.add(j,"at",function(x,y){u=y.key;if(u.length==0){e.custEvent.fire(g,"close");return}var w=e.common.trans.at.getTrans("followList",{onSuccess:function(B,E){if(!e.core.dom.contains(document.body,p)){document.body.appendChild(p)}var A=e.core.util.easyTemplate(n,B.data);e.custEvent.fire(g,"open",y.textarea);var C=STK.core.dom.builder(A);var D=C.box;c.innerHTML=D;p.style.cssText=["z-index:11001;background-color:#ffffff;position:absolute;"].join("");var z=y.l;if(document.body.clientWidth<(y.fl+e.core.dom.getSize(p).width)&&y.fl>e.core.dom.getSize(p).width){z=y.l-e.core.dom.getSize(p).width}e.kit.dom.layoutPos(p,y.textarea,{pos:"left-top",offsetX:z,offsetY:y.t})},onError:function(){e.custEvent.fire(g,"close")}}).request({q:u})})};var b=function(){m=t.textEl;j=STK.module.at({textEl:m})};var f=function(w){e.custEvent.remove(w);e.removeEvent(t.textEl,"blur",h)};var r=function(w){d=0;p&&(p.style.display="none");p&&(p.innerHTML="");e.removeNode(p);p=STK.C("div");e.core.util.hideContainer.appendChild(p);if(p.innerHTML.length==0){p.innerHTML=l;c=e.core.dom.sizzle('[node-type="suggestWrap"]',p)[0]}if(g){e.custEvent.fire(g,"close");f(g)}g=e.module.suggest({textNode:w,uiNode:c,actionType:"item",actionData:"value"});o()};var q=function(w){s=e.sizzle("li[class!=title]",c);e.core.dom.removeClassName(s[d],"cur");e.core.dom.addClassName(s[w],"cur");d=w};return function(x,w){t=x.nodeList;var y={};y.init=function(){b();r(t.textEl);v()};return y}});STK.register("common.editor.base",function(c){var b={limitNum:140};function a(){}return function(h,d){var i={};var l,j,g,m;l=c.kit.extra.merge(b,d);j=c.module.editor(h,l);g=j.nodeList;m=[];if(typeof d.count=="undefined"||d.count=="enable"){var f=c.common.editor.plugin.count(j,l)}var e=c.common.editor.plugin.at(j,l);e.init();j.init();j.widget=function(o,p,n){m.push(o);o.init(j,p,n);return j};j.closeWidget=function(){if(m&&m.length!=0){for(var o=0,n=m.length;o<n;o++){m[o].hide()}}};return j}});STK.register("module.layer",function(b){var c=function(e){var d={};if(e.style.display=="none"){e.style.visibility="hidden";e.style.display="";d.w=e.offsetWidth;d.h=e.offsetHeight;e.style.display="none";e.style.visibility="visible"}else{d.w=e.offsetWidth;d.h=e.offsetHeight}return d};var a=function(g,f){f=f||"topleft";var e=null;if(g.style.display=="none"){g.style.visibility="hidden";g.style.display="";e=b.core.dom.position(g);g.style.display="none";g.style.visibility="visible"}else{e=b.core.dom.position(g)}if(f!=="topleft"){var d=c(g);if(f==="topright"){e.l=e.l+d.w}else{if(f==="bottomleft"){e.t=e.t+d.h}else{if(f==="bottomright"){e.l=e.l+d.w;e.t=e.t+d.h}}}}return e};return function(h){var l=b.core.dom.builder(h);var g=l.list.outer[0],e=l.list.inner[0];var j=b.core.dom.uniqueID(g);var i={};var d=b.core.evt.custEvent.define(i,"show");b.core.evt.custEvent.define(d,"hide");var f=null;i.show=function(){g.style.display="";b.core.evt.custEvent.fire(d,"show");return i};i.hide=function(){g.style.display="none";window.setTimeout(function(){b.core.evt.custEvent.fire(d,"hide")},0);return i};i.getPosition=function(m){return a(g,m)};i.getSize=function(m){if(m||!f){f=c.apply(i,[g])}return f};i.html=function(m){if(m!==undefined){e.innerHTML=m}return e.innerHTML};i.text=function(m){if(text!==undefined){e.innerHTML=b.core.str.encodeHTML(m)}return b.core.str.decodeHTML(e.innerHTML)};i.appendChild=function(m){e.appendChild(m);return i};i.getUniqueID=function(){return j};i.getOuter=function(){return g};i.getInner=function(){return e};i.getParentNode=function(){return g.parentNode};i.getDomList=function(){return l.list};i.getDomListByKey=function(m){return l.list[m]};i.getDom=function(n,m){if(!l.list[n]){return false}return l.list[n][m||0]};i.getCascadeDom=function(n,m){if(!l.list[n]){return false}return b.core.dom.cascadeNode(l.list[n][m||0])};return i}});STK.register("kit.extra.reuse",function(a){return function(e,j){var i,h,b;i=a.parseParam({},j);b=[];var f=function(){var l=e();b.push({store:l,used:true});return l};var g=function(l){a.foreach(b,function(n,m){if(l===n.store){n.used=true;return false}})};var d=function(l){a.foreach(b,function(n,m){if(l===n.store){n.used=false;return false}})};var c=function(){for(var m=0,l=b.length;m<l;m+=1){if(b[m]["used"]===false){b[m]["used"]=true;return b[m]["store"]}}return f()};h={};h.setUsed=g;h.setUnused=d;h.getOne=c;h.getLength=function(){return b.length};return h}});STK.register("module.dialog",function(b){var a=function(){box.style.top=spec.t+"px";box.style.left=spec.l+"px";return that};return function(m,n){if(!m){throw"module.dialog need template as first parameter"}var j,f,g,e,l,i,p,h,c;c=true;var d=function(){if(c!==false){f.hide()}};var o=function(){j=b.parseParam({t:null,l:null,width:null,height:null},n);f=b.module.layer(m,j);e=f.getOuter();l=f.getDom("title");h=f.getDom("title_content");i=f.getDom("inner");p=f.getDom("close");b.addEvent(p,"click",function(){f.hide()});b.custEvent.add(f,"show",function(){b.hotKey.add(document.documentElement,["esc"],d,{type:"keyup",disableInInput:true})});b.custEvent.add(f,"hide",function(){b.hotKey.remove(document.documentElement,["esc"],d,{type:"keyup"});c=true})};o();g=f;g.setPosition=function(q){e.style.top=q.t+"px";e.style.left=q.l+"px";return g};g.setMiddle=function(){var q=b.core.util.winSize();var r=f.getSize(true);e.style.top=b.core.util.scrollPos()["top"]+(q.height-r.h)/2+"px";e.style.left=(q.width-r.w)/2+"px";return g};g.setTitle=function(q){h.innerHTML=q;return g};g.setContent=function(q){if(typeof q==="string"){i.innerHTML=q}else{i.appendChild(q)}return g};g.clearContent=function(){while(i.children.length){b.removeNode(i.children[0])}return g};g.setAlign=function(){};g.unsupportEsc=function(){c=false};g.supportEsc=function(){c=true};return g}});STK.register("kit.dom.fix",function(d){var a=!(d.core.util.browser.IE6||(document.compatMode!=="CSS1Compat"&&STK.IE)),b=/^(c)|(lt)|(lb)|(rt)|(rb)$/;function c(g){return d.core.dom.getStyle(g,"display")!="none"}function e(h){h=d.core.arr.isArray(h)?h:[0,0];for(var g=0;g<2;g++){if(typeof h[g]!="number"){h[g]=0}}return h}function f(j,s,n){if(!c(j)){return}var r="fixed",u,v,g,q,l=j.offsetWidth,m=j.offsetHeight,o=d.core.util.winSize(),p=0,t=0,h=d.kit.dom.cssText(j.style.cssText);if(!a){r="absolute";var i=d.core.util.scrollPos();p=u=i.top;t=v=i.left;switch(s){case"lt":u+=n[1];v+=n[0];break;case"lb":u+=o.height-m-n[1];v+=n[0];break;case"rt":u+=n[1];v+=o.width-l-n[0];break;case"rb":u+=o.height-m-n[1];v+=o.width-l-n[0];break;case"c":default:u+=(o.height-m)/2+n[1];v+=(o.width-l)/2+n[0]}g=q=""}else{u=q=n[1];v=g=n[0];switch(s){case"lt":q=g="";break;case"lb":u=g="";break;case"rt":v=q="";break;case"rb":u=v="";break;case"c":default:u=(o.height-m)/2+n[1];v=(o.width-l)/2+n[0];q=g=""}}if(s=="c"){if(u<p){u=p}if(v<t){v=t}}h.push("position",r).push("top",u+"px").push("left",v+"px").push("right",g+"px").push("bottom",q+"px");j.style.cssText=h.getCss()}return function(h,o,i){var j,p,l=true,g;if(d.core.dom.isNode(h)&&b.test(o)){var m={getNode:function(){return h},isFixed:function(){return l},setFixed:function(q){(l=!!q)&&f(h,j,p);return this},setAlign:function(q,r){if(b.test(q)){j=q;p=e(r);l&&f(h,j,p)}return this},destroy:function(){if(!a){a&&d.core.evt.removeEvent(window,"scroll",n)}d.core.evt.removeEvent(window,"resize",n);d.core.evt.custEvent.undefine(g)}};g=d.core.evt.custEvent.define(m,"beforeFix");m.setAlign(o,i);function n(q){q=q||window.event;d.core.evt.custEvent.fire(g,"beforeFix",q.type);if(l&&(!a||j=="c")){f(h,j,p)}}if(!a){d.core.evt.addEvent(window,"scroll",n)}d.core.evt.addEvent(window,"resize",n);return m}}});STK.register("module.mask",function(e){var m,c=[],h,n,d;var g=e.core.dom.setStyle;var j=e.core.dom.getStyle;var l=e.core.evt.custEvent;var b={},a;function i(){m=e.C("div");var o='<div node-type="outer">';if(e.core.util.browser.IE6){o+='<div style="position:absolute;width:100%;height:100%;"></div>'}o+="</div>";m=e.builder(o).list.outer[0];document.body.appendChild(m);n=true;h=e.kit.dom.fix(m,"lt");var p=function(){var q=e.core.util.winSize();m.style.cssText=e.kit.dom.cssText(m.style.cssText).push("width",q.width+"px").push("height",q.height+"px").getCss()};d=l.add(h,"beforeFix",p);p()}var f={getNode:function(){return m},show:function(p,o){if(n){p=e.core.obj.parseParam({opacity:0.1,background:"#000000"},p);m.style.background=p.background;g(m,"opacity",p.opacity);m.style.display="block";h.setAlign("lt");o&&o()}else{e.Ready(function(){i();f.show(p,o)})}return f},hide:function(q){if(m&&q){if(a!=q){delete b[e.core.dom.uniqueID(q)]}else{var r=e.core.dom.prev(m);if(a){delete b[e.core.dom.uniqueID(a)];a=undefined}var p=false;for(var o=0;r&&o<3;o++){if(b[e.core.dom.uniqueID(r)]){p=true;break}r=e.core.dom.prev(r)}if(p){f.showUnderNode(r)}else{m.style.display="none"}r=undefined}}q=undefined;return f},showUnderNode:function(p,o){if(e.isNode(p)){(a=p);b[e.core.dom.uniqueID(p)]=1;f.show(o,function(){g(m,"zIndex",j(p,"zIndex"));document.body.appendChild(m);document.body.appendChild(p)})}return f},destroy:function(){l.remove(d);m.style.display="none";a=undefined;b={}}};return f});STK.register("kit.dom.drag",function(a){return function(d,q){var h,g,o,m,c,l,e,i;var r=function(){f();j()};var f=function(){h=a.parseParam({moveDom:d,perchStyle:"border:solid #999999 2px;",dragtype:"perch",actObj:{},pagePadding:5},q);o=h.moveDom;g={};m={};c=a.drag(d,{actObj:h.actObj});if(h.dragtype==="perch"){l=a.C("div");e=false;i=false;o=l}d.style.cursor="move"};var j=function(){a.custEvent.add(h.actObj,"dragStart",n);a.custEvent.add(h.actObj,"dragEnd",b);a.custEvent.add(h.actObj,"draging",p)};var n=function(s,v){document.body.style.cursor="move";var u=a.core.util.pageSize()["page"];m=a.core.dom.position(h.moveDom);m.pageX=v.pageX;m.pageY=v.pageY;m.height=h.moveDom.offsetHeight;m.width=h.moveDom.offsetWidth;m.pageHeight=u.height;m.pageWidth=u.width;if(h.dragtype==="perch"){var t=[];t.push(h.perchStyle);t.push("position:absolute");t.push("z-index:"+(h.moveDom.style.zIndex+10));t.push("width:"+h.moveDom.offsetWidth+"px");t.push("height:"+h.moveDom.offsetHeight+"px");t.push("left:"+m.l+"px");t.push("top:"+m.t+"px");l.style.cssText=t.join(";");i=true;setTimeout(function(){if(i){document.body.appendChild(l);e=true}},100)}if(d.setCapture!==undefined){d.setCapture()}};var b=function(s,t){document.body.style.cursor="auto";if(d.setCapture!==undefined){d.releaseCapture()}if(h.dragtype==="perch"){i=false;h.moveDom.style.top=l.style.top;h.moveDom.style.left=l.style.left;if(e){document.body.removeChild(l);e=false}}};var p=function(u,B){var A=m.t+(B.pageY-m.pageY);var t=m.l+(B.pageX-m.pageX);var v=A+m.height;var w=t+m.width;var s=m.pageHeight-h.pagePadding;var z=m.pageWidth-h.pagePadding;if(v<s&&A>0){o.style.top=A+"px"}else{if(A<0){o.style.top="0px"}if(v>=s){o.style.top=s-m.height+"px"}}if(w<z&&t>0){o.style.left=t+"px"}else{if(t<0){o.style.left="0px"}if(w>=z){o.style.left=z-m.width+"px"}}};r();g.destroy=function(){document.body.style.cursor="auto";if(typeof o.setCapture==="function"){o.releaseCapture()}if(h.dragtype==="perch"){i=false;if(e){document.body.removeChild(l);e=false}}a.custEvent.remove(h.actObj,"dragStart",n);a.custEvent.remove(h.actObj,"dragEnd",b);a.custEvent.remove(h.actObj,"draging",p);if(c.destroy){c.destroy()}h=null;o=null;m=null;c=null;l=null;e=null;i=null};g.getActObj=function(){return h.actObj};return g}});STK.register("ui.dialog",function(d){var c='<div class="W_layer" node-type="outer" style="display:none;position:absolute;z-index:10001"><div class="bg"><table border="0" cellspacing="0" cellpadding="0"><tr><td><div class="content"><div class="title" node-type="title"><span node-type="title_content"></span></div><a href="javascript:void(0);" class="W_close" title="关闭" node-type="close"></a><div node-type="inner"></div></div></td></tr></table></div></div>';var e=d.kit.extra.language;var b=null;var a=function(){var g=d.module.dialog(c);d.custEvent.add(g,"show",function(){d.module.mask.showUnderNode(g.getOuter())});d.custEvent.add(g,"hide",function(){d.module.mask.hide(g.getOuter());g.setMiddle()});d.kit.dom.drag(g.getDom("title"),{actObj:g,moveDom:g.getOuter()});g.destroy=function(){f(g);try{g.hide()}catch(h){}};return g};var f=function(g){g.setTitle("").clearContent();b.setUnused(g)};return function(g){var h=d.parseParam({isHold:false},g);var j=h.isHold;h=d.core.obj.cut(h,["isHold"]);if(!b){b=d.kit.extra.reuse(a)}var i=b.getOne();if(!j){d.custEvent.add(i,"hide",function(){d.custEvent.remove(i,"hide",arguments.callee);f(i)})}return i}});STK.register("ui.alert",function(d){var c='<div node-type="outer" class="layer_point"><dl class="point clearfix"><dt><span class="" node-type="icon"></span></dt><dd node-type="inner"><p class="S_txt1" node-type="textLarge"></p><p class="S_txt2" node-type="textSmall"></p></dd></dl><div class="btn"><a href="javascript:void(0)" class="W_btn_d" node-type="OK"></a></div></div>';var f={success:"icon_succM",error:"icon_errorM",warn:"icon_warnM","delete":"icon_delM",question:"icon_questionM"};var e=d.kit.extra.language;var b=null;var a=function(h,g){h.getDom("icon").className=g.icon;h.getDom("textLarge").innerHTML=g.textLarge;h.getDom("textSmall").innerHTML=g.textSmall;h.getDom("OK").innerHTML="<span>"+g.OKText+"</span>"};return function(n,h){var i,j,m,o,g;i=d.parseParam({title:e("#L{提示}"),icon:"warn",iconSize:"",textLarge:n,textSmall:"",OK:d.funcEmpty,OKText:e("#L{确定}"),timeout:0},h);if(i.iconSize){var l=f[i.icon];l=l.substr(0,l.length-1)+i.iconSize;f[i.icon]=l}i.icon=f[i.icon];j={};if(!b){b=d.kit.extra.reuse(function(){var p=d.module.layer(e(c));return p})}m=b.getOne();o=d.ui.dialog();o.setContent(m.getOuter());o.setTitle(i.title);a(m,i);d.addEvent(m.getDom("OK"),"click",o.hide);d.custEvent.add(o,"hide",function(){d.custEvent.remove(o,"hide",arguments.callee);d.removeEvent(m.getDom("OK"),"click",o.hide);b.setUnused(m);clearTimeout(g);i.OK()});if(i.timeout){g=setTimeout(o.hide,i.timeout)}o.show().setMiddle();j.alt=m;j.dia=o;return j}});STK.register("module.bubble",function(a){return function(h,i){if(!h){throw"module.bubble need template as first parameter"}var f;var g,e,d,l,j,c;g=a.parseParam({width:null,height:null,parent:document.body},i);e=a.module.layer(h);d=e.getDom("outer");l=e.getDom("inner");if(e.getDomListByKey("close")){j=e.getDom("close")}d.style.display="none";c=false;var b=function(n){if(c){return true}var m=a.fixEvent(n);if(!a.contains(d,m.target)){e.hide()}};if(j){a.addEvent(j,"click",e.hide)}a.custEvent.add(e,"show",function(){setTimeout(function(){a.addEvent(document.body,"click",b)},0)});a.custEvent.add(e,"hide",function(){c=false;a.removeEvent(document.body,"click",b)});f=e;f.setPosition=function(m){d.style.top=m.t+"px";d.style.left=m.l+"px";return f};f.setLayout=function(m,n){if(!a.isNode(m)){throw"module.bubble.setDown need element as first parameter"}a.kit.dom.layoutPos(d,m,n);return f};f.setContent=function(m){if(typeof m==="string"){l.innerHTML=m}else{if(a.isNode(m)){l.appendChild(m)}}return f};f.setArrow=function(m){var n;if(e.getDomListByKey("arrow")){n=e.getDom("arrow");n.className=m.className||"";n.style.cssText=m.style||""}};f.clearContent=function(){while(l.children.length){a.removeNode(l.children[0])}};f.stopBoxClose=function(){c=true};f.startBoxClose=function(){c=false};f.destroy=function(){a.removeEvent(document.body,"click",b);e=null;d=null;l=null;j=null};return f}});STK.register("ui.bubble",function(d){var c='<div class="W_layer" node-type="outer"><div class="bg"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td><div class="content"><a class="W_close" href="javascript:void(0);" node-type="close" title="关闭"></a><div node-type="inner"></div></div></td></tr></tbody></table><div class="arrow arrow_t"></div></div></div>';var b=[];var h=function(i){var j=d.module.bubble(c,i);d.custEvent.add(j,"hide",function(){a(j);e(j)});b.push({bub:j,used:true});return j};var e=function(i){i.clearContent();document.body.appendChild(i.getOuter())};var g=function(m){for(var l=0,j=b.length;l<j;l+=1){if(m===b[l]["bub"]){b[l]["used"]=true;return}}};var a=function(m){for(var l=0,j=b.length;l<j;l+=1){if(m===b[l]["bub"]){b[l]["used"]=false;return}}};var f=function(l){var n;for(var m=0,j=b.length;m<j;m+=1){if(!b[m]["used"]){b[m]["used"]=true;n=b[m]["bub"];return n}}n=h(l);return n};return function(i){return f(d.parseParam({},i))}});STK.register("common.trans.editor",function(d){var a=d.kit.io.inter();var c=a.register,b=location.host;if(b=="app.weibo.com"){c("face",{url:"/aj_face.php"});c("magicFace",{url:"/aj_face.php?type=ani"})}else{c("face",{url:"/aj/mblog/face?type=face"});c("magicFace",{url:"/aj/mblog/face?type=ani"})}return a});STK.register("common.magic",function(f){var h=f.core.util.swf;var b=f.module.mask;var a,l,c,j,d,e;var g=function(){if(a){return}a=f.C("div");a.style.cssText="display:none;width:440px;height:360px;z-index:100000;";l=f.core.dom.uniqueID(a);d=function(m){m=f.fixEvent(m||window.event);if(m.target.getAttribute("name")!=l){i.hide()}};document.body.appendChild(a)};var i=function(m,n){g();if(c){return}c=true;b.showUnderNode(a);f.addEvent(b.getNode(),"click",d);b.getNode().title="点击关闭";a.style.display="";if(!j){j=f.kit.dom.fix(a,"c")}else{j.setAlign("c")}a.innerHTML=h.html(m,{id:l,width:440,height:360,paras:{allowScriptAccess:"never",wmode:"transparent"},attrs:{name:l},flashvars:{playMovie:"true"}});clearInterval(e);e=setInterval(function(){var p=document[l]||window[l],o=0;if(p&&p.PercentLoaded()==100){clearInterval(e);e=setInterval(function(){var s=p.CurrentFrame(),q;try{q=p.TotalFrames()}catch(r){q=p.TotalFrames}if(s<0){return}if(s<q&&o<=s){o=s}else{i.hide()}},80)}},100)};i.hide=function(){if(a){a.style.display="none";a.innerHTML=""}clearInterval(e);f.removeEvent(b.getNode(),"click",d);b.getNode().title="";b.hide(a);c=false;return i};i.destroy=function(){i.hide();j&&j.destroy();f.removeNode(a);e=a=l=c=j=d};return i});STK.register("common.app.parse",function(a){return function(f){if(f.code!=="A00006"){return f}var g={};g.code="100000";g.msg="";g.data={};g.data.more={};g.data.usual={};var d=function(i){var h={category:i.title,common:false,hot:false,icon:i.icon,phrase:i.value,picid:"",type:"face",url:i.src,value:i.value};return h};var c=function(){var j=[];var n=f.data.norm[0];for(var l=0,h=n.length;l<h;l++){var m=n[l];var o=d(m);j.push(o)}return j};g.data.usual.norm=c();var b=function(){var p={};var q=f.data&&f.data.more;if(!q){return{}}for(var m=0,n=q.length;m<n;m++){var r=q[m]["type"];p[r]=[];var o=q[m]["icon"][0];for(var h=0;h<o.length;h++){var t=o[h];var l=d(t);p[r].push(l)}}return p};g.data.more=b();var e=function(){var j=[];var n=f.data.hot;for(var l=0,h=n.length;l<h;l++){var m=n[l];var o=d(m);j.push(o)}return j};if(f.data.hot){g.data.usual.hot=e()}return g}});STK.register("common.app.version",function(a){return function(){var b={};b.isNew=(document.domain==="app.weibo.com"?true:false);return b}});STK.register("common.bubble.face",function(h){var t=h.common.app.version();var e='<div node-type="outer" class="layer_faces clearfix"><div class="tab S_txt2"><p><a href="javascript:void(0);"  node-type="general">常用表情</a><em class="W_vline">|</em><a href="javascript:void(0);"  node-type="magic">魔法表情</a></p></div><div class=""><p class="tab_kind S_link2"><span class="right"><a href="javascript:void(0);" node-type="prev" action-type="prev" class="W_btn_c_disable btn_page_prevdis"><span><em class="W_ico12 ico_page_prev"></em></span></a><a href="javascript:void(0);" node-type="next" action-type="next" class="W_btn_c btn_page_next"><span><em class="W_ico12 ico_page_next"></em></span></a></span><em node-type="categorys"></em><div class="detail"><ul class="faces_list faces_list_hot clearfix" node-type="hotFace"></ul><ul class="faces_list" node-type="inner"></ul><div class="W_pages_minibtn" node-type="page"></div></div></div></div>';var i='<a href="javascript:void(0);" onclick="return false;" action-type="category" action-data="category=#{item}">#{item}</a>';var q='<a href="javascript:void(0);" onclick="return false;" action-type="category" action-data="category=#{item}" class="current S_txt1">#{item}</a>';var n='<li action-type="insert" action-data="text=#{phrase}"><img src="#{icon}" alt="#{phrase}" /></li>';var v='<li><a action-type="insert" action-data="text=#{value}" class="img" href="javascript:void(0);"><img src="#{icon}" alt="#{phrase}" /></a><a title="表情预览" class="A_icon_play" href="javascript:void(0);" action-type="play" action-data="swf=#{swf}"></a><span>#{phrase}</span></li>';var B='<a action-type="page" action-data="num=#{number}" href="javascript:void(0);" class="page S_bg1" onclick="return false;">#{label}</a>';var b='<a action-type="page" action-data="num=#{number}" href="javascript:void(0);" class="page S_txt1" onclick="return false;">#{label}</a>';var g='<div class="W_loading"><span>正在加载，请稍候...</span></div>';var p='<li class="clear"></li>';var r='<em class="W_vline">|</em>';var z=5;var o="默认";var f,w,A,y,d,l;l={};var x=function(F){var I=F.cPoniter;var E=F.categorys;var H=F.currentCategory;var G=E.slice(I,I+z);G=h.foreach(G,function(K,J){if(H===K){return h.templet(q,{item:K})}else{return h.templet(i,{item:K})}});w.categorys.innerHTML=G.join(r);if(I+z>=E.length){w.next.className="W_btn_c_disable btn_page_nextdis"}else{w.next.className="W_btn_c btn_page_next"}if(I<=0){w.prev.className="W_btn_c_disable btn_page_prevdis"}else{w.prev.className="W_btn_c btn_page_prev"}};var a=function(F){var I=F.page;var H=F.cache[F.currentCategory];var G=H.length/F.itemNumber;var J=[];for(var E=0;E<G;E+=1){if(I==E){J.push(h.templet(b,{number:E,label:E+1}))}else{J.push(h.templet(B,{number:E,label:E+1}))}}w.page.innerHTML=J.join("");if(I===0&&F===m&&F.currentCategory===o){w.hotFace.style.display=""}else{w.hotFace.style.display="none"}};var s={general:function(E){d=m;d.init();w.general.className="current S_txt1";w.magic.className="";w.inner.className="faces_list clearfix"},magic:function(E){d=j;d.init();w.general.className="";w.magic.className="current S_txt1";w.inner.className="faces_magic_list"}};var D={category:function(E){d.page=0;d.currentCategory=E.data.category;d.rend();setTimeout(function(){x(d);a(d)},0)},prev:function(F){var G=d.cPoniter;var E=d.categorys;if(G<=0){return false}d.cPoniter-=z;x(d)},next:function(F){var G=d.cPoniter;var E=d.categorys;if(G>=E.length-z){return false}d.cPoniter+=z;x(d)},play:function(E){h.common.magic(E.data.swf)},insert:function(E){h.custEvent.fire(l,"insert",{value:E.data.text})},page:function(E){d.page=parseInt(E.data.num,10);d.rend();setTimeout(function(){a(d)},0)}};var u=function(E){A=h.ui.bubble();c();C();s[E]();h.custEvent.add(A,"hide",(function(F){return function(){h.custEvent.remove(F,"hide",arguments.callee);h.custEvent.fire(l,"hide",{})}})(A))};var c=function(){f=h.module.layer(e);w={};var F=f.getDomList();for(var E in F){w[E]=F[E][0]}c=function(){A.setContent(w.outer)};c()};var C=function(){h.custEvent.define(l,"insert");h.custEvent.define(l,"hide");h.addEvent(w.general,"click",s.general);h.addEvent(w.magic,"click",s.magic);delegate=h.core.evt.delegatedEvent(w.outer);delegate.add("category","click",D.category);delegate.add("prev","click",D.prev);delegate.add("next","click",D.next);delegate.add("insert","click",D.insert);delegate.add("play","click",D.play);delegate.add("page","click",D.page);C=function(){}};var m={init:function(){w.inner.innerHTML=g;h.common.trans.editor.getTrans("face",{onSuccess:function(F,H){F=h.common.app.parse(F);m.cache=F.data.more||{};try{m.hotList=F.data.usual.hot.slice(0,10);w.hotFace.innerHTML=h.foreach(m.hotList,function(J,I){return h.templet(n,J)}).join("")}catch(G){}m.categorys=[o];for(var E in m.cache){m.categorys.push(E)}m.cache[o]=F.data.usual.norm;m.init=function(){m.page=0;m.cPoniter=0;m.currentCategory=o;m.rend();x(m);a(m)};m.init()},onError:function(E,F){},onFail:function(E,F){h.ui.alert("接口请求错误")}}).request({})},rend:function(){var H=m.currentCategory;var G=m.cache[H];var F=m.page;var E=m.itemNumber;G=G.slice(F*E,F*E+E);G=h.foreach(G,function(J,I){return h.templet(n,J)});w.inner.innerHTML=G.join("")},page:0,cache:null,hotList:null,cPoniter:0,categorys:[],currentCategory:o,itemNumber:40};var j={init:function(){w.inner.innerHTML=g;w.hotFace.style.display="none";h.common.trans.editor.getTrans("magicFace",{onSuccess:function(F,G){F=h.common.app.parse(F);j.cache=F.data.more||{};j.categorys=[o];for(var E in j.cache){j.categorys.push(E)}j.cache[o]=F.data.usual.norm;j.init=function(){j.page=0;j.cPoniter=0;j.currentCategory=o;j.rend();x(j);a(j)};j.init()},onError:function(E,F){},onFail:function(E,F){h.ui.alert("接口请求错误")}}).request({type:"ani"})},rend:function(G,F){var J=j.currentCategory;var I=j.cache[J];var H=j.page;var E=j.itemNumber;I=I.slice(H*E,H*E+E);I=h.foreach(I,function(L,K){L.swf=L.icon.slice(0,-4)+".swf";return h.templet(v,L)});I.push(p);w.inner.innerHTML=I.join("")},page:0,cache:null,cPoniter:0,categorys:[],currentCategory:o,itemNumber:10};l.getBub=function(){return A};return function(F,G){if(!h.isNode(F)){throw"common.bubble.face need el as first parameter!"}var E=h.parseParam({l:0},G);u("general");A.setLayout(F,{offsetX:-29,offsetY:5});A.show();return l}});STK.register("common.editor.widget.face",function(a){return function(c){var f={};var e,h,i,d;d=a.parseParam({t:0,l:-15},c);var g=function(j,l){e.API.insertText(l.value);h.getBub().hide()};var b=function(){a.core.evt.preventDefault();h=a.common.bubble.face(e.nodeList[i],d);a.custEvent.add(h,"insert",g);a.custEvent.add(h,"hide",function(){a.custEvent.remove(h,"hide",arguments.callee);a.custEvent.remove(h,"insert",g)})};f.init=function(j,l,m){e=j;i=l;a.addEvent(j.nodeList[i],"click",b)};f.clear=function(){};f.show=function(){};f.hide=function(){};f.destroy=function(){e=null};return f}});STK.register("kit.extra.crc32",function(a){return function(f,d){function j(m){m=m.replace(/\r\n/g,"\n");var i="";for(var p=0;p<m.length;p++){var o=m.charCodeAt(p);if(o<128){i+=String.fromCharCode(o)}else{if((o>127)&&(o<2048)){i+=String.fromCharCode((o>>6)|192);i+=String.fromCharCode((o&63)|128)}else{i+=String.fromCharCode((o>>12)|224);i+=String.fromCharCode(((o>>6)&63)|128);i+=String.fromCharCode((o&63)|128)}}}return i}f=j(f);var l="00000000 77073096 EE0E612C 990951BA 076DC419 706AF48F E963A535 9E6495A3 0EDB8832 79DCB8A4 E0D5E91E 97D2D988 09B64C2B 7EB17CBD E7B82D07 90BF1D91 1DB71064 6AB020F2 F3B97148 84BE41DE 1ADAD47D 6DDDE4EB F4D4B551 83D385C7 136C9856 646BA8C0 FD62F97A 8A65C9EC 14015C4F 63066CD9 FA0F3D63 8D080DF5 3B6E20C8 4C69105E D56041E4 A2677172 3C03E4D1 4B04D447 D20D85FD A50AB56B 35B5A8FA 42B2986C DBBBC9D6 ACBCF940 32D86CE3 45DF5C75 DCD60DCF ABD13D59 26D930AC 51DE003A C8D75180 BFD06116 21B4F4B5 56B3C423 CFBA9599 B8BDA50F 2802B89E 5F058808 C60CD9B2 B10BE924 2F6F7C87 58684C11 C1611DAB B6662D3D 76DC4190 01DB7106 98D220BC EFD5102A 71B18589 06B6B51F 9FBFE4A5 E8B8D433 7807C9A2 0F00F934 9609A88E E10E9818 7F6A0DBB 086D3D2D 91646C97 E6635C01 6B6B51F4 1C6C6162 856530D8 F262004E 6C0695ED 1B01A57B 8208F4C1 F50FC457 65B0D9C6 12B7E950 8BBEB8EA FCB9887C 62DD1DDF 15DA2D49 8CD37CF3 FBD44C65 4DB26158 3AB551CE A3BC0074 D4BB30E2 4ADFA541 3DD895D7 A4D1C46D D3D6F4FB 4369E96A 346ED9FC AD678846 DA60B8D0 44042D73 33031DE5 AA0A4C5F DD0D7CC9 5005713C 270241AA BE0B1010 C90C2086 5768B525 206F85B3 B966D409 CE61E49F 5EDEF90E 29D9C998 B0D09822 C7D7A8B4 59B33D17 2EB40D81 B7BD5C3B C0BA6CAD EDB88320 9ABFB3B6 03B6E20C 74B1D29A EAD54739 9DD277AF 04DB2615 73DC1683 E3630B12 94643B84 0D6D6A3E 7A6A5AA8 E40ECF0B 9309FF9D 0A00AE27 7D079EB1 F00F9344 8708A3D2 1E01F268 6906C2FE F762575D 806567CB 196C3671 6E6B06E7 FED41B76 89D32BE0 10DA7A5A 67DD4ACC F9B9DF6F 8EBEEFF9 17B7BE43 60B08ED5 D6D6A3E8 A1D1937E 38D8C2C4 4FDFF252 D1BB67F1 A6BC5767 3FB506DD 48B2364B D80D2BDA AF0A1B4C 36034AF6 41047A60 DF60EFC3 A867DF55 316E8EEF 4669BE79 CB61B38C BC66831A 256FD2A0 5268E236 CC0C7795 BB0B4703 220216B9 5505262F C5BA3BBE B2BD0B28 2BB45A92 5CB36A04 C2D7FFA7 B5D0CF31 2CD99E8B 5BDEAE1D 9B64C2B0 EC63F226 756AA39C 026D930A 9C0906A9 EB0E363F 72076785 05005713 95BF4A82 E2B87A14 7BB12BAE 0CB61B38 92D28E9B E5D5BE0D 7CDCEFB7 0BDBDF21 86D3D2D4 F1D4E242 68DDB3F8 1FDA836E 81BE16CD F6B9265B 6FB077E1 18B74777 88085AE6 FF0F6A70 66063BCA 11010B5C 8F659EFF F862AE69 616BFFD3 166CCF45 A00AE278 D70DD2EE 4E048354 3903B3C2 A7672661 D06016F7 4969474D 3E6E77DB AED16A4A D9D65ADC 40DF0B66 37D83BF0 A9BCAE53 DEBB9EC5 47B2CF7F 30B5FFE9 BDBDF21C CABAC28A 53B39330 24B4A3A6 BAD03605 CDD70693 54DE5729 23D967BF B3667A2E C4614AB8 5D681B02 2A6F2B94 B40BBE37 C30C8EA1 5A05DF1B 2D02EF8D";var d;if(typeof(d)=="undefined"){d=0}var h=0;var g=0;d=d^(-1);for(var c=0,b=f.length;c<b;c++){g=(d^f.charCodeAt(c))&255;h="0x"+l.substr(g*9,8);d=(d>>>8)^h}var e=d^(-1);if(e<0){e=4294967296+e}return e}});STK.register("common.extra.imageURL",function(a){return function(e,c){var i={size:"small"};if(typeof e!="string"){return}i=a.core.obj.parseParam(i,c);var l=i.size;function f(m){m=(m+"").replace(/[^a-f0-9]/gi,"");return parseInt(m,16)}var h={ss:{middle:"&690",bmiddle:"&690",small:"&690",thumbnail:"&690",square:"&690",orignal:"&690"},ww:{middle:"bmiddle",large:"large",bmiddle:"bmiddle",small:"small",thumbnail:"thumbnail",square:"square",orignal:"large"}};var b=e.charAt(9)=="w";var g=e.charAt(21)=="g"?".gif":".jpg";var j=b?(a.kit.extra.crc32(e)%4+1):(f(e.substr(19,2))%16+1);var d="http://"+(b?"ww":"ss")+j+".sinaimg.cn/"+(b?h.ww[l]:l)+"/"+e+(b?g:"")+(b?"":h.ss[l]);return d}});STK.register("module.editorPlugin.tab",function(a){return function(p,i){var q=a.core.evt.addEvent,g=a.core.dom.addClassName,j=a.core.dom.removeClassName,f=a.core.arr.isArray,h=a.core.evt.preventDefault,e=a.core.dom.setStyle,d,c,o,s,b,r,m;function n(x){var w=(f(o))?o[x]:o,l=d[x],v=f(c)?c[x]:null;otNode=d[m],odNode=f(c)?c[m]:null;if(x==m){return}if(v){e(c[m],"display","none");e(c[x],"display","")}j(d[m],b);g(d[x],b);w({idx:x,node:v});m=x}function u(){if(!f(d)){throw"module.editorPlugin.tab needs tNodes as Array!"}if(!f(c)){throw"module.editorPlugin.tab needs tNodes as Array!"}if(d.length!=c.length){throw"module.editorPlugin.tab needs tNodes'length equal to dNodes'length!"}}function t(w,v){var x={evtType:"click",tNodes:"",dNodes:"",className:"cur",cb:function(){},defaultIdx:0};x=a.core.obj.parseParam(x,v);o=x.cb;b=x.className;m=x.defaultIdx;s=x.evtType;d=(typeof x.tNodes=="string")?a.sizzle(x.tNodes,w):x.tNodes;r=d.length;if(x.dNodes!==""){c=(typeof x.dNodes=="string")?a.sizzle(x.dNodes,w):x.dNodes;u()}for(var l=0;l<r;l++){q(d[l],s,function(y){return function(){h();n(y)}}(l))}}t(p,i)}});STK.register("common.bubble.image",function(z){var I='<div node-type="outer"><div class="layer_send_pic" node-type="wrap"><div node-type="inner"><div class="tab W_textb"><p><a class="current" href="javascript:void(0);" node-type="tab">#L{上传图片}</a><a href="javascript:void(0);" node-type="tab">#L{推荐配图}</a></p></div><div node-type="content"></div></div><div node-type="uploaded" style="display:none"><div class="laPic_tit"><span node-type="pName"></span><span class="right"><a href="javascript:void(0);" action-type="delete">#L{删除}</a></span></div><div node-type="picWrap" class="laPic_Pic"></div></div></div>';var e='<div node-type="uppic"><div class="laPic_btn"  style="width:230px;"><a href="javascript:void(0);" class="W_btn_a choose_pic" node-type="inputCover"><span>#L{从电脑选择图片}</span><form node-type="form" action-type="form" id="pic_upload" name="pic_upload" target="upload_target" enctype="multipart/form-data" method="POST" action=""><input class="input_f" type="file" hidefoucs="true" style="" node-type="fileBtn" name="pic1"/></form></a></div><div class="laPic_con W_textb"  node-type="info">#L{请选择小于5M的gif、jpg、png图片}</div></div><div node-type="loading"  style="width:230px;display:none"><div class="laPic_con"><div class="W_loading"><span>#L{图片正在上传，请等待}...</span></div></div><div class="laPic_btn"><a href="javascript:void(0);" class="W_btn_a" action-type="cancel"><span>#L{取消上传}</span></a></div></div>';var c='<p class="tab_kind W_linkb"><span class="right"><a class="pre_d" action-type="prev" node-type="prev" href="javascript:void(0);"></a><a class="next" action-type="next" node-type="next" href="javascript:void(0);"></a></span><em node-type="categorys"></em></p><div node-type="loading"></div><div class="detail"><ul node-type="list" class="faces_magic_list clearfix"></ul><div node-type="page" class="W_pages_minibtn"></div></div>';var M='<div class="W_loading"><span>正在加载，请稍候...</span></div>';var b='<a href="javascript:void(0);" onclick="return false;" action-type="category" action-data="category=#{item}">#{item}</a>';var j='<a href="javascript:void(0);"  onclick="return false;" action-type="category" action-data="category=#{item}" class="current W_texta">#{item}</a>';var w='<li><a action-type="insertSmiley" action-data="url=#{thumb}&pid=#{picid}&value=#{value}" class="img" href="javascript:void(0);"><img src="#{thumb}" original="#{original}" title="#{value}" alt="#{phrase}" /></a><span title="#{value}"  action-type="insertSmiley" action-data="url=#{thumb}&pid=#{picid}&value=#{value}">#{phrase}</span></li>';var t='<a action-type="page" action-data="num=#{number}" href="javascript:void(0);">#{label}</a>';var H='<a action-type="page" action-data="num=#{number}" href="javascript:void(0);" class="current"  onclick="return false;">#{label}</a>';var n='<em class="W_vline">|</em>';var B="默认";var l="#L{分享图片}";var s=5;var C="weibo.com/";var r,a,x,i,f,A;var u,J,o;var D={};var G={alert:"#L{上传的图片不正确}",outdate:"#L{上传图片超时}"};var v={page:0,cache:null,cPoniter:0,categorys:[],currentCategory:B,itemNumber:10};var E;var F=z.core.dom.position;var g=z.core.evt.addEvent;var m=z.core.evt.removeEvent;var h=z.kit.extra.language;var d=function(){z.custEvent.define(D,"uploaded");z.custEvent.define(D,"hide");z.custEvent.define(D,"insert");z.custEvent.define(D,"deletePIC");z.custEvent.define(D,"picLoad");z.custEvent.add(r,"hide",(function(L){return function(){z.custEvent.remove(L,"hide",arguments.callee);z.custEvent.fire(D,"hide",{})}})(r));z.module.editorPlugin.tab(a,{evtType:"click",tNodes:'[node-type="tab"]',className:"current",cb:[p.init,y.init]});o=z.core.evt.delegatedEvent(a);p.bind()};var p={init:function(){p.initDom();p.bind()},initDom:function(){var L;A=p;E.wrap.className="layer_send_pic";E.content.innerHTML=h(e);E.close=(r.getDomList().close)[0];L=z.kit.dom.parseDOM(z.core.dom.builder(a).list);E=z.kit.extra.merge(E,L);p.exchangeInput()},bind:function(){g(E.inputCover,"mousemove",p.ajust);g(E.fileBtn,"change",K.upload);o.add("delete","click",p.deletePic);o.add("cancel","click",p.cancelUpload)},destroy:function(){m(E.inputCover,"mousemove",p.ajust);m(E.fileBtn,"change",K.upload)},handle:function(L){if(!L||L.ret<0){var N=L?G.alert:G.outdate;z.ui.alert(h(N),{OK:function(){r.hide()}})}else{p.stopUpload();if(f){E.uppic.style.display="";f=false}else{p.rendSucc(L)}}},rendLoad:function(){r.stopBoxClose();E.uppic.style.display="none";E.loading.style.display=""},ajust:function(T){var X=z.fixEvent(T);var L=E.inputCover;var O=E.fileBtn;var U=F(L);var V=z.scrollPos();var P=V.top+X.clientY;var Q=V.left+X.clientX;var S=parseInt(O.offsetWidth/2),R=parseInt(O.offsetHeight/2);var W=P-U.t;var Y=Q-U.l;var N=[];N.push("left:"+(Y-S)+"px");N.push("top:"+(W-R)+"px");O.style.cssText=N.join(";")},rendSucc:function(P){var O=z.common.extra.imageURL(P.pid);var L=[],N,Q;L=u.split(/\/|\\/);N=L[L.length-1];L=N.split(".");if(z.bLength(L[0])>20){L[0]=z.leftB(L[0],20);Q=[L[0],"...",L[1]].join("")}else{Q=N}K.loadPic({url:O,value:Q,pid:P.pid})},deletePic:function(){E.close.style.display="";E.inner.style.display="";E.wrap.style.width="";E.uploaded.style.display="none";E.picWrap.innerHTML="";E.fileBtn.value="";A.destroy();A.init();r.startBoxClose();z.custEvent.fire(D,"deletePIC",{text:h(l)})},stopUpload:function(){E.loading.style.display="none";E.uppic.style.display=""},cancelUpload:function(){f=true;r.startBoxClose()},exchangeInput:function(){var Q=E.fileBtn;var P=Q.parentNode;var L=Q.className;var N=Q.name;var O=z.C("input");O.className=L;O.name=N;O.type="file";O.hidefocus="true";E.fileBtn=O;P.removeChild(Q);P.appendChild(O)}};var y={init:function(){var L;E.wrap.className="content layer_faces";A=y;p.destroy();E.content.innerHTML=h(c);L=z.kit.dom.parseDOM(z.core.dom.builder(a).list);E=z.kit.extra.merge(E,L);if(!J){E.loading.innerHTML=h(M)}y.cartoonStart();y.bind()},bind:function(){o.add("insertSmiley","click",function(L){STK.core.evt.preventDefault();var N=L.data.url;var P=L.data.pid;var O=L.data.value;K.loadPic({url:N,value:O,pid:P})});o.add("category","click",function(L){v.page=0;v.currentCategory=L.data.category;y.rend();setTimeout(function(){y.rendCategory(v);y.rendPage(v)},0)});o.add("prev","click",function(L){var N=v.cPoniter;if(N<=0){return false}v.cPoniter-=s;y.rendCategory(v)});o.add("next","click",function(N){var O=v.cPoniter;var L=v.categorys;if(O>=L.length-s){return false}v.cPoniter+=s;y.rendCategory(v)});o.add("page","click",function(L){v.page=parseInt(L.data.num,10);y.rend();setTimeout(function(){y.rendPage(v)},0)})},cartoonStart:function(){z.common.trans.editor.getTrans("cartoon",{onSuccess:function(N,O){v.cache=N.data.more||{};v.categorys=[B];for(var L in v.cache){v.categorys.push(L)}v.cache[B]=N.data.usual.norm;y.cartoonStart=function(){v.page=0;v.cPoniter=0;v.currentCategory=B;y.rend();y.rendCategory(v);y.rendPage(v)};y.cartoonStart()}}).request({})},rend:function(O,N){var R=v.currentCategory;var Q=v.cache[R];var P=v.page;var L=v.itemNumber;Q=Q.slice(P*L,P*L+L);Q=z.foreach(Q,function(T,S){if(z.bLength(T.phrase)>8){T.phrase=[z.leftB(T.phrase,6),"..."].join("")}return z.templet(h(w),T)});E.loading.innerHTML="";E.list.innerHTML=Q.join("")},rendCategory:function(N){var Q=N.cPoniter;var L=N.categorys;var P=N.currentCategory;var O=L.slice(Q,Q+s);O=z.foreach(O,function(S,R){if(P===S){return z.templet(h(j),{item:S})}else{return z.templet(h(b),{item:S})}});E.categorys.innerHTML=O.join(n);if(Q+6>=L.length){["next"].className="next_d"}else{E.next.className="next"}if(Q<=0){E.prev.className="pre_d"}else{E.prev.className="pre"}},rendPage:function(N){var Q=N.page;var P=N.cache[N.currentCategory];var O=P.length/N.itemNumber;var R=[];for(var L=0;L<O;L+=1){if(Q==L){R.push(z.templet(h(H),{number:L,label:L+1}))}else{R.push(z.templet(h(t),{number:L,label:L+1}))}}E.page.innerHTML=R.join("")},destroy:function(){}};var K={upload:function(){u=E.fileBtn.value;if(z.core.str.trim(u)===""){return}p.rendLoad();z.common.trans.editor.getTrans("waterMark",{onSuccess:function(L,N){z.log(L);z.core.io.ijax({url:"http://picupload.service.weibo.com/interface/pic_upload.php",form:STK.E("pic_upload"),abaurl:"http://"+document.domain+"/aj/static/upimgback.html",abakey:"cb",onComplete:p.handle,onTimeout:p.handle,args:{marks:1,app:"miniblog",s:"rdxt",url:(L.data.domain=="1")?C+$CONFIG.domain:0,markpos:L.data.position||"",logo:L.data.logo||"",nick:(L.data.nickname=="1")?"@"+$CONFIG.nick:0}})}}).request()},loadPic:function(O){var N=O.url;var P=E.close;var L=z.C("img");if(O.value){E.pName.innerHTML=O.value}L.src=N;r.stopBoxClose();z.core.evt.custEvent.fire(D,"uploaded",{text:h(l),pid:O.pid});E.wrap.className="layer_send_pic";E.wrap.style.width="240px";E.inner.style.display="none";E.uploaded.style.display="";P.style.display="none";E.picWrap.appendChild(L);z.log("11111")}};var q={};D.getBub=function(){return r};return function(N,O){if(!z.isNode(N)){throw"common.bubble.image need el as first parameter!"}E=z.kit.dom.parseDOM(z.core.dom.builder(h(I)).list);r=z.ui.bubble();a=E.outer;p.initDom();if(O&&O.pid){z.log("ffffffffffffff",O.pid);var L=z.common.extra.imageURL(O.pid);K.loadPic({url:L,pid:O.pid})}d();r.setContent(a);r.setLayout(N,{offsetX:-29,offsetY:5});r.show();D.bubble=r;return D}});STK.register("common.editor.widget.image",function(a){return function(e){a.log(e);var f={};var g,d,j,l,c;var m=function(n,o){g.API.insertText(o.value);d.getBub().hide()};var b=function(n,o){a.log("upload");var p=g.API.getWords();if(p.length==0){g.API.insertText(o.text)}g.API.addExtraInfo(o.pid);l=true};var h=function(n,o){g.API.delWords(o.text);g.API.addExtraInfo("");clearInterval(c)};var i=function(n){if(l){return}a.core.evt.preventDefault();if(typeof n=="string"){d=a.common.bubble.image(g.nodeList[j],{pid:n});a.log("has pid");c=setInterval(function(){d.bubble.setLayout(g.nodeList[j],{offsetX:-29,offsetY:5})},200)}else{d=a.common.bubble.image(g.nodeList[j])}a.custEvent.add(d,"uploaded",b);a.log(2222);a.custEvent.add(d,"insert",m);a.custEvent.add(d,"deletePIC",h);a.custEvent.add(d,"hide",function(){a.custEvent.remove(d,"hide",arguments.callee);a.custEvent.remove(d,"uploaded",b);a.custEvent.remove(d,"insert",m);a.custEvent.remove(d,"deletePIC",h);a.custEvent.remove(d,"changeType");l=false})};f.init=function(n,o,p){g=n;j=o;a.addEvent(n.nodeList[j],"click",i);if(p&&p.pid){i(p.pid)}};f.clear=function(){};f.show=function(){};f.hide=function(){if(d){d.getBub().hide()}};f.resetBubble=function(n){if(d){d.bubble.setLayout(n,{offsetX:-29,offsetY:5})}};f.destroy=function(){g=null};return f}});STK.register("common.trans.feed",function(e){var b=e.kit.io.inter();var d=b.register,c=location.host,a=(c=="weibo.com"?"/app":"");d("publish",{url:a+"/aj_scoremb.php",method:"post"});d("delete",{url:"/aj/mblog/del",method:"post"});d("forward",{url:"/aj/mblog/forward",method:"post"});d("mediaShow",{url:"/aj/mblog/show",method:"get"});d("profileSearch",{url:"/aj/mblog/mbloglist",method:"get"});d("homeSearch",{url:"/aj/mblog/fsearch",method:"get"});d("atMeSearch",{url:"/ajax/atme/list",method:"get"});d("atMeShield",{url:"/aj/at/mblog/shield",method:"post"});return b});STK.register("common.channel.feed",function(b){var a=["forward","publish","comment","delete","refresh"];return b.common.listener.define("common.channel.feed",a)});STK.register("common.extra.shine",function(b){var a=function(c){return c.slice(0,c.length-1).concat(c.concat([]).reverse())};return function(e,r){var o=b.parseParam({start:"#fff",color:"#fbb",times:2,step:5},r);var f=o.start.split("");var c=o.color.split("");var h=[];for(var n=0;n<o.step;n+=1){var p=f[0];for(var l=1;l<4;l+=1){var m=parseInt(f[l],16);var g=parseInt(c[l],16);p+=Math.floor(parseInt(m+(g-m)*n/o.step,10)).toString(16)}h.push(p)}for(var n=0;n<o.times;n+=1){h=a(h)}var q=false;var d=b.timer.add(function(){if(!h.length){b.timer.remove(d);return}if(q){q=false;return}else{q=true}e.style.backgroundColor=h.pop()})}});STK.register("common.dialog.publish",function(d){var c='<#et temp data><div class="layer_grade" node-type="outer"><div class="detail layer_forward" ><div class="W_texta recommend_star detail_infor clearfix" ><span class="comment_state state_ok"><em class="icon_succ state_icon"></em></span><div class="comment_reason" node-type="info"></div></div><div class="feed_repeat"><div class="input clearfix"><p class="num" node-type="num"></p><textarea name="" class="W_inputStp" node-type="textEl"></textarea><div class="state" style="display:none" node-type="successTip"><p class="state_succ"><span class="icon_succ state_icon"></span>发布成功</p></div><div class="action clearfix" node-type="widget"><#if (data.smileyBtn)><a href="javascript:void(0);" class="action_face" node-type="smileyBtn"><span class="A_icon_faces"></span><em class="W_arrowDown"></em></a></#if><#if (data.picBtn)><a href="javascript:void(0);" class="img"  node-type="picBtn" >#L{图片}</a></#if></div><p class="btn"><a href="javascript:void(0);" class="W_btn_b" node-type="submit"><span>发布</span></a></p></div></div></div></div>';var b={title:"#L{有什么新鲜事想告诉大家}"};var e=d.kit.extra.language;var a={limitNum:140};return function(r){var t={};var w,H,u,D,J,l,j,g,B,m;w=d.parseParam({styleId:"1",smileyBtn:true,picBtn:true,pid:""},r);g=d.custEvent.define(t,"publish");d.custEvent.define(t,"hide");var I=function(){if(H){if(u==="error"){d.common.extra.shine(J.textEl)}return}H=true;u="loading";var L=K();j.request(L)};var K=function(){var O=l.API.getWords();if(B){if(O.indexOf(B)===-1){O=O+B}}var Q={};Q.id=$CONFIG.$appId||"";Q.score=$CONFIG.$score||0;Q.content=O||"";var L=l.API.getExtra();if(L){if(L.indexOf("=")<0){Q.pic_id=l.API.getExtra()||""}else{var P=L;var N=d.core.json.queryToJson(P);for(var M in N){Q[M]=N[M]}d.log(Q)}}return Q};var A=function(L){if((L.keyCode===13||L.keyCode===10)&&L.ctrlKey){I();l.API.blur()}};var s=function(L,N){var M=N.isOver;if(!M){H=false;u="";J.submit.className="W_btn_b";J.num.innerHTML="<span>"+(140-N.count)+"</span>字"}else{H=true;u="error";J.submit.className="W_btn_b_disable";J.num.innerHTML="<span>"+(140-N.count)+"</span>"}};var p=function(L,M){if(L.code=="100001"||L.code=="20019"){return}u="";J.successTip.style.display="";J.textEl.value="";setTimeout(function(){J.successTip.style.display="none";D&&D.hide();H=false},2*1000);d.custEvent.fire(g,"publish",[L.data,M]);d.common.channel.feed.fire("publish",[L.data,M])};var C=function(L,M){H=false;u="";d.ui.alert(L.msg)};var n=function(L,M){H=false;u="";d.ui.alert()};var h=function(L){J.textEl.value="";l.API.insertText(L.content);J.info.innerHTML=L.info;if(L.content){H=false;u="";J.submit.className="W_btn_b"}else{H=true;u="error";J.submit.className="W_btn_b_disable"}};var v=function(){H=false};var f=function(){l=d.common.editor.base(d.core.util.easyTemplate(d.kit.extra.language(c),w).toString(),a);w.smileyBtn&&l.widget(d.common.editor.widget.face(),"smileyBtn");w.picBtn&&l.widget(d.common.editor.widget.image(),"picBtn");J=l.nodeList};var i=function(){d.addEvent(J.submit,"click",I);d.addEvent(J.textEl,"keypress",A)};var q=function(){d.custEvent.add(l,"textNum",s)};var z=function(){j=d.common.trans.feed.getTrans("publish",{onComplete:function(L,M){p(L,M)},onError:C,onFail:n})};var o=function(){f();i();q();z()};var G=function(M){if(!l){o()}var L=d.parseParam({content:"",defaultValue:"",info:"",title:e(b.title)},M);D=d.ui.dialog();D.setTitle(L.title);D.appendChild(J.outer);D.show();D.setMiddle();h(L);l.API.focus();d.custEvent.add(D,"hide",function(){d.custEvent.remove(D,"hide",arguments.callee);l.closeWidget();v();D=null;d.custEvent.fire(g,"hide")});B=L.defaultValue};var y=function(){D.hide()};var x=function(L){l.API.addExtraInfo(L)};var F=function(L){l.API.reset();l.API.insertText(L)};var E=function(){if(D){D.hide()}d.removeEvent(J.submit,"click",I);d.removeEvent(J.textEl,"keypress",A);d.custEvent.remove(l,"textNum",s);d.custEvent.undefine(g,"publish");J=null;j=null;H=false;for(k in t){delete t[k]}t=null};t.addExtraInfo=x;t.updatePubInfo=F;t.show=G;t.hide=y;t.destroy=E;return t}});STK.register("common.app.gradePublish",function(d){var c=d.core.evt.addEvent,f=d.core.evt.custEvent,b=d.kit.extra.language,h=d.templet;var g=[b("#L{推荐给我的粉丝}"),b("#L{我来评分}")],e=["推荐应用【#{appName}】#{url}","我给应用【#{appName}】打了#{score}分  #{url}"],a=document.location.href;var i='<p class="recommend" node-type="starpub" ><span class="star_tip">#{info}</span><i class="allstar"><i class="star_bar" node-type="star" style="width:#{percent}"></i></i><span class="star_total"><strong node-type="score">#{score}</strong>分</span><span node-type="desc" class="grade_state">#{desc}</span></p><p>'+b("#L{顺便发一条微博告诉大家吧：}")+"</p>";return function(y,p){var q={};var x,t,l,u,B,v;B=$CONFIG.$appName||"";var s={mark:false,type:""};var m=d.parseParam(s,p);var w=function(){};var j=function(){};var n=function(){};var A=function(){t=d.common.dialog.publish({picBtn:false})};var r=function(){};var o={showPublisher:function(H,G){G=G||{score:$CONFIG.$score||0,desc:$CONFIG.$score==0?b("#L{未评分}"):b("#L{您已评分}")};G.desc="("+G.desc+")";var F,C,E,J=parseInt(G.score,10),I=J*20+"%";var D={appName:B,score:J+".0",percent:I,desc:G.desc,info:"",url:a};switch(H){case"1":F=b("#L{推荐给我的粉丝}");D.info="给"+B+"评个分";C=h(i,D);E=h(e[0],D);break;case"2":F=b("#L{我来评分}");D.info="你给"+B+"的评分是";C=h(i,D);E=h(e[1],D);break;default:F=g[1];D.info="给"+B+"评个分";C=h(i,D);E="#"+B+"#"}t.show({title:F,info:C,content:E});if(m.mark){u=d.common.app.grade(d.sizzle("[node-type=starpub]")[0],{handler:"publisher"});f.add(u,"mark",function(L,K){o.updateInfo(K)})}},updateInfo:function(D){var C=h(e[1],{appName:B,score:parseInt(D.score,10),url:a});t.updatePubInfo(C)}};var z=function(){w();j();n();A();r()};z();q.options=m;q.showPublisher=o.showPublisher;return q}});STK.register("comp.app.grade",function(d){var c=d.core.evt.addEvent,a=d.core.evt.custEvent,b=d.kit.extra.language,e=d.templet;var b=d.kit.extra.language;return function(u,m){var t,g,r,y=window.$CONFIG||{};var z,i=260;var n={};var p=false;var q;var w=function(){if(d.core.util.browser.IE6){if(z.offsetWidth>i+20+1){z.style.width=i+"px"}}};var s=function(){if(!u){throw"node is not defined"}};var f=function(){t=d.kit.dom.parseDOM(d.core.dom.builder(u).list);z=t.app_intro;if(!t.star){throw"can not find nodes in comp.app.grade"}q=d.sizzle(".allstar",u)[1]};var h=function(){c(t.recommend,"click",function(){r.options.mark=true;r.showPublisher("1")})};var j={show:function(){if(p){t.desc.style.display="";q.style.display=""}},hide:function(){if(p){t.desc.style.display="none";q.style.display="none"}}};var x=function(){g=d.common.app.grade(u);r=d.common.app.gradePublish();w()};var l=function(){a.add(g,"mark",function(B,A){r.options.mark=false;r.showPublisher("2",A);!p&&o()})};var o=function(){var A=d.sizzle(".my_score_note",u)[0];A&&(A.innerHTML=b("#L{我已评分}"));p=true};var v=function(){s();f();x();h();l()};v()}});STK.pageletM.register("pl.app.grade",function(c){var b=c.E("pl_app_grade");var a=c.comp.app.grade(b);return a});STK.register("common.app.slider",function(f){var b=f.core.evt.addEvent,a=f.core.dom.getStyle,e=f.core.dom.setStyle,d=f.core.dom.setStyles,c=f.core.dom.insertBefore,h=f.core.dom.insertAfter;return function(F,z){if(!F){throw"it needs node for slider"}var t={};var v={step:1,speed:1000,show:3,auto:true,pause:2000,extraBtn:false,extraBtnEvt:true,vertical:false,continuous:true,controlsFade:true,screennum:2,carousel:false,beforeSlide:null,slideCbk:null,duration:500,hoverEvt:false,full:true,animationType:"linear",prevBtnClassName:"W_btn_c btn_page_prev",nextBtnClassName:"W_btn_c btn_page_next",prevBtnDisableClassName:"W_btn_c_disable btn_page_prev",nextBtnDisableClassName:"W_btn_c_disable btn_page_next"};var m=f.parseParam(v,z);var H={};H.prevBtn=F.prev;H.nextBtn=F.next;H.extraBtn=F.extrabtn;H.slider=F.slider;H.btnlist=[];H.dir="next";H.speed=m.speed;if(!H.slider){throw"no slider box found"}var B=H.slider.parentNode,q=false;if(B.style.display=="none"){q=true;B.style.visibility="hidden";B.style.display=""}var y=H.slider.getElementsByTagName("ul")[0],x=y.getElementsByTagName("li"),K=x.length;if(!K){return}var E=x[0].offsetWidth+parseInt(a(x[0],"marginLeft"))+parseInt(a(x[0],"marginRight")),C=x[0].offsetHeight+parseInt(a(x[0],"marginTop"))+parseInt(a(x[0],"marginBottom")),M=(m.full)?Math.floor((K-m.show)/m.step):((K%m.show==0)?(K/m.show-1):(Math.floor(K/m.show))),r=0,n=true,p=false,s=K;if(q){B.style.visibility="visible";B.style.display="none"}e(H.slider,"overflow","hidden");e(y,"width",s*E+"px");if(!m.vertical){for(var J=0;J<K;J++){e(x[J],"float","left")}}var D=function(i,O,N){if(f.core.arr.isArray(i)){f.core.arr.foreach(i,function(P,Q){b(P,O,N)})}else{b(i,O,N)}};if(H.prevBtn&&H.nextBtn){D(H.prevBtn,"click",function(){A("prev",true)});D(H.nextBtn,"click",function(){A("next",true)})}if(m.hoverEvt){b(H.slider,"mouseover",function(){G()});b(H.slider,"mouseout",function(){o()})}var u={set:function(O){if(H.btnlist.length===0){return}for(var N=0;N<H.btnlist.length;N++){f.removeClassName(H.btnlist[N],"current")}f.addClassName(H.btnlist[O],"current")},add:function(){var Q=Math.floor(K/m.show);for(var P=0;P<Q;P++){var N=f.C("a");N.href="javascript:;";N.innerHTML=parseInt(P+1);if(m.extraBtnEvt){N.onclick=(function(i){return function(){u.scroll(i)}})(P)}H.extraBtn.appendChild(N)}var O=f.sizzle("a",H.extraBtn);H.btnlist=O;u.set(r);return O},scroll:function(N){var i="next";if(N===r){return}else{if(N<r){r=N+1;r=m.carousel?1:r;i="prev"}else{r=N-1;r=m.carousel?0:r}}j(i,false)}};if(m.extraBtn&&(K/m.show>=m.screennum)){u.add()}if(m.controlsFade){if(M+1>=m.screennum){d(H.prevBtn,"display","");d(H.nextBtn,"display","")}else{d(H.prevBtn,"display","none");d(H.nextBtn,"display","none")}H.prevBtn.className=m.prevBtnDisableClassName;H.nextBtn.className=m.nextBtnClassName}var l=function(){};var L=f.core.ani.tween(y,{duration:m.duration,animationType:m.animationType,end:function(){p=false;if(m.auto){I()}m.slideCbk&&m.slideCbk({slider:y,dir:H.dir,itemWidth:E,index:r,items:x,item:x[r]})}});var w;var o=function(){if(m.auto){I()}};var G=function(){clearTimeout(w)};var I=function(i){i=i||"next";clearTimeout(w);w=setTimeout(function(){j(i,false)},H.speed)};var A=function(i,N){if(p){return}p=true;j(i);G()};o();function j(N){var O=r;switch(N){case"next":r=(r>=M)?(m.continuous?0:M):r+1;O=m.carousel?1:r;break;case"prev":r=(r<=0)?(m.continuous?M:0):r-1;O=m.carousel?0:r;break;case"first":O=r=0;break;case"last":O=r=M;break;default:break}H.dir=N;m.beforeSlide&&m.beforeSlide({slider:y,index:r,dir:H.dir,itemWidth:E,items:x,item:x[r]});var i;if(!m.vertical){i=(O*E*m.step*-1);L.play({marginLeft:i})}else{i=(O*C*m.step*-1);L.play({marginTop:i})}if(m.controlsFade){if(r==0){n=false;H.prevBtn.className=m.prevBtnDisableClassName;H.nextBtn.className=m.nextBtnClassName}else{if(r==M){n=false;H.prevBtn.className=m.prevBtnClassName;H.nextBtn.className=m.nextBtnDisableClassName}else{n=true;H.prevBtn.className=m.prevBtnClassName;H.nextBtn.className=m.nextBtnClassName}}}u.set(r)}};var g=function(){slider()};g();that.slider=slider;return that});STK.register("comp.app.gallery",function(e){var b=e.core.evt.addEvent,a=e.core.dom.getStyle,d=e.core.dom.setStyle,c=e.core.dom.insertBefore,f=e.core.dom.insertAfter;return function(j,g){var i,p=e.core.dom.builder,r=e.kit.dom.parseDOM,l=false;var m={width:450,height:300};var s=function(){if(!j){throw"node is not defined"}l=e.hasClassName(j,"set_smaller");if(l){m={width:336,height:224}}};var h=function(){i=e.kit.dom.parseDOM(e.core.dom.builder(j).list)};var q=function(){};var o=function(v){var u=new Image();u.src=v.src;u.onload=function(){if(u.width>0&&u.height>0){if(u.width/u.height>=m.width/m.height){if(u.width>m.width){v.style.width=m.width+"px";v.style.height=(u.height*m.width)/u.width+"px"}else{v.style.width=u.width+"px";v.style.height=u.height+"px"}}else{if(u.height>m.height){v.style.height=m.height+"px";v.style.width=(u.width*m.height)/u.height+"px"}else{v.style.width=u.width+"px";v.style.height=u.height+"px"}}}}};var n=function(){var x=function(A,z){var B=A[0];var C=A[A.length-1];if(z=="next"){e.core.dom.insertAfter(B,C)}else{e.core.dom.insertBefore(C,B)}};var v=function(z){e.core.arr.foreach(z,function(A,B){A.className=""})};e.common.app.slider(i,{auto:false,continuous:true,controlsFade:false,carousel:true,screennum:1,extraBtn:false,show:1,step:1,beforeSlide:function(E){var D=E.slider,C=E.items,z=E.item,B=E.index,A=E.dir;if(A=="prev"){x(C,A);d(D,"marginLeft",-E.itemWidth+"px")}},slideCbk:function(E){var D=E.slider,C=E.items,z=E.item,B=E.index,A=E.dir;if(A=="next"){x(C,A);d(D,"marginLeft","0")}}});var y=e.sizzle("img",i.slider);for(var w=0,u=y.length;w<u;w++){o(y[w])}};var t=function(){s();h();q();n()};t()}});STK.pageletM.register("pl.app.gallery",function(c){var b=c.E("pl_app_gallery");var a=c.comp.app.gallery(b)});STK.register("ui.confirm",function(c){var b='<div node-type="outer" class="layer_point"><dl class="point clearfix"><dt><span class="" node-type="icon"></span></dt><dd node-type="inner"><p class="W_texta" node-type="textLarge"></p><p class="W_textb" node-type="textComplex"></p><p class="W_textb" node-type="textSmall"></p></dd></dl><div class="btn"><a href="javascript:void(0)" class="W_btn_a" node-type="OK"></a><a href="javascript:void(0)" class="W_btn_c" node-type="cancel"></a></div></div>';var e={success:"icon_succB",error:"icon_errorB",warn:"icon_warnB","delete":"icon_delB",question:"icon_questionM"};var d=c.kit.extra.language;var a=null;return function(g,n){var m,l,h,o,j,f;m=c.parseParam({title:d("#L{提示}"),icon:"question",textLarge:g,textComplex:"",textSmall:"",OK:c.funcEmpty,OKText:d("#L{确定}"),cancel:c.funcEmpty,cancelText:d("#L{取消}")},n);m.icon=e[m.icon];l={};if(!a){a=c.kit.extra.reuse(function(){var p=c.module.layer(b);return p})}h=a.getOne();o=c.ui.dialog();o.setContent(h.getOuter());h.getDom("icon").className=m.icon;h.getDom("textLarge").innerHTML=m.textLarge;h.getDom("textComplex").innerHTML=m.textComplex;h.getDom("textSmall").innerHTML=m.textSmall;h.getDom("OK").innerHTML="<span>"+m.OKText+"</span>";h.getDom("cancel").innerHTML="<span>"+m.cancelText+"</span>";o.setTitle(m.title);var i=function(){j=true;f=c.htmlToJson(h.getDom("textComplex"));o.hide()};c.addEvent(h.getDom("OK"),"click",i);c.addEvent(h.getDom("cancel"),"click",o.hide);c.custEvent.add(o,"hide",function(){c.custEvent.remove(o,"hide",arguments.callee);c.removeEvent(h.getDom("OK"),"click",i);c.removeEvent(h.getDom("cancel"),"click",o.hide);a.setUnused(h);if(j){m.OK(f)}else{m.cancel(f)}});o.show().setMiddle();l.cfm=h;l.dia=o;return l}});STK.register("common.trans.global",function(d){var a=d.kit.io.inter();var c=a.register,b=location.host;if(b=="app.weibo.com"){c("language",{url:"/aj_profile.php",method:"post"})}else{c("language",{url:"/aj/user/lang",method:"post"})}return a});STK.register("comp.content.changeLanguage",function(a){var b=null;return function(d){var g={},c=a.kit.extra.language,l={"zh-cn":c("#L{确认切换到简体版吗}"),"zh-tw":c("#L{确认切换到繁体版吗}")};var e=(function(){var o=function(q){window.location.reload()};var n=a.common.trans.global.getTrans("language",{onSuccess:o});return function(p){n.request({lang:p})}})();var f={changeLanguage:function(){var n=d.value;a.ui.confirm(l[n],{OK:function(){e(n)},cancel:function(){d.value=$CONFIG.$lang}})}};var i=function(){if(!a.core.dom.isNode(d)){throw"[STK.comp.content.changeLanguage]:node is not a Node!"}};var h=function(){a.addEvent(d,"change",f.changeLanguage)};var j=function(){a.removeEvent(d,"change",f.changeLanguage);f.changeLanguage&&(f.changeLanguage=null)};var m=function(){if(b){return}b=d;i();h()}();g.destroy=function(){return};return g}});STK.pageletM.register("pl.content.changeLanguage",function(b){var a=b.E("pl_content_changeLanguage");b.comp.content.changeLanguage(a)});STK.register("template.app.detail",function(c){var b={};var a='<table node-type="outer"><tr  ><td class="key_name">地址二：</td><td class="key_value"><input type="text" class="default_input gallery_input" index="2" ></input><span class="default_form_note"><i style="display:none;" class="note_icon note_icon_alert"></i><em style="display:none;" class="note_text_error">请输入正确的微博地址</em></span></td></tr></table>';b.formItemTemplate=a;return b});STK.register("ui.mod.layer",function(b){var c=function(e){var d={};if(e.style.display=="none"){e.style.visibility="hidden";e.style.display="";d.w=e.offsetWidth;d.h=e.offsetHeight;e.style.display="none";e.style.visibility="visible"}else{d.w=e.offsetWidth;d.h=e.offsetHeight}return d};var a=function(g,f){f=f||"topleft";var e=null;if(g.style.display=="none"){g.style.visibility="hidden";g.style.display="";e=b.core.dom.position(g);g.style.display="none";g.style.visibility="visible"}else{e=b.core.dom.position(g)}if(f!=="topleft"){var d=c(g);if(f==="topright"){e.l=e.l+d.w}else{if(f==="bottomleft"){e.t=e.t+d.h}else{if(f==="bottomright"){e.l=e.l+d.w;e.t=e.t+d.h}}}}return e};return function(h){var l=b.core.dom.builder(h);var g=l.list.outer[0],e=l.list.inner[0];var j=b.core.dom.uniqueID(g);var i={};var d=b.core.evt.custEvent.define(i,"show");b.core.evt.custEvent.define(d,"hide");var f=null;i.show=function(){g.style.display="";b.core.evt.custEvent.fire(d,"show");return i};i.hide=function(){g.style.display="none";b.custEvent.fire(d,"hide");return i};i.getPosition=function(m){return a(g,m)};i.getSize=function(m){if(m||!f){f=c.apply(i,[g])}return f};i.html=function(m){if(m!==undefined){e.innerHTML=m}return e.innerHTML};i.text=function(m){if(m!==undefined){e.innerHTML=b.core.str.encodeHTML(m)}return b.core.str.decodeHTML(e.innerHTML)};i.appendChild=function(m){e.appendChild(m);return i};i.getUniqueID=function(){return j};i.getOuter=function(){return g};i.getInner=function(){return e};i.getParentNode=function(){return g.parentNode};i.getDomList=function(){return l.list};i.getDomListByKey=function(m){return l.list[m]};i.getDom=function(n,m){if(!l.list[n]){return false}return l.list[n][m||0]};i.getCascadeDom=function(n,m){if(!l.list[n]){return false}return b.core.dom.cascadeNode(l.list[n][m||0])};return i}});STK.register("ui.mask",function(e){var l,c=[],b,j=false,a="STK-Mask-Key";var g=e.core.dom.setStyle,i=e.core.dom.getStyle,h=e.core.evt.custEvent;function d(){l=e.C("div");var n='<div node-type="outer">';if(e.core.util.browser.IE6){n+='<div style="position:absolute;width:100%;height:100%;"></div>'}n+="</div>";l=e.builder(n).list.outer[0];document.body.appendChild(l);j=true;b=e.kit.dom.fix(l,"lt");var o=function(){var p=e.core.util.winSize();l.style.cssText=e.core.dom.cssText(l.style.cssText).push("width",p.width+"px").push("height",p.height+"px").getCss()};h.add(b,"beforeFix",o);o()}function m(n){var o;if(!(o=n.getAttribute(a))){n.setAttribute(a,o=e.getUniqueKey())}return">"+n.tagName.toLowerCase()+"["+a+'="'+o+'"]'}var f={getNode:function(){return l},show:function(o,n){if(j){o=e.core.obj.parseParam({opacity:0.3,background:"#000000"},o);l.style.background=o.background;g(l,"opacity",o.opacity);l.style.display="";b.setAlign("lt");n&&n()}else{d();f.show(o,n)}return f},hide:function(){l.style.display="none";c=[];return f},showUnderNode:function(o,n){if(e.isNode(o)){f.show(n,function(){g(l,"zIndex",i(o,"zIndex"));var q=m(o);var p=e.core.arr.indexOf(c,q);if(p!=-1){c.splice(p,1)}c.push(q);e.core.dom.insertElement(o,l,"beforebegin")})}return f},back:function(){if(c.length<1){return f}var o,n;c.pop();if(c.length<1){f.hide()}else{if((n=c[c.length-1])&&(o=e.sizzle(n,document.body)[0])){g(l,"zIndex",i(o,"zIndex"));e.core.dom.insertElement(o,l,"beforebegin")}else{f.back()}}return f},destroy:function(){h.remove(b);l.style.display="none"}};return f});STK.register("ui.litePrompt",function(a){var c=a.kit.extra.language;var b=a.core.util.easyTemplate;return function(d,m){var j,i,g,n,f;var m=a.parseParam({hideCallback:a.core.func.empty,type:"succM",msg:"",timeout:""},m);var l=m.template||'<#et temp data><div class="W_layer" node-type="outer"><div class="bg"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td><div class="content layer_mini_info_big" node-type="inner"><p class="clearfix"><span class="icon_${data.type}"></span>${data.msg}&nbsp; &nbsp; &nbsp;</p></div></td></tr></tbody></table></div></div></#et>';var e=b(l,{type:m.type,msg:d}).toString();i={};g=a.ui.mod.layer(e);f=g.getOuter();a.custEvent.add(g,"hide",function(){a.ui.mask.back();m.hideCallback&&m.hideCallback();a.custEvent.remove(g,"hide",arguments.callee);clearTimeout(n)});a.custEvent.add(g,"show",function(){document.body.appendChild(f);a.ui.mask.showUnderNode(f);a.ui.mask.getNode().style.zIndex=10002});g.show();if(m.timeout){n=setTimeout(g.hide,m.timeout)}var h=a.core.util.winSize();var o=g.getSize(true);f.style.top=a.core.util.scrollPos()["top"]+(h.height-o.h)/2+"px";f.style.left=(h.width-o.w)/2+"px";f.style.zIndex=10002;i.layer=g;return i}});STK.register("comp.app.tabContent",function(f){var a;var b=f.common.trans.app;var e=f.core.dom.addClassName;var h=f.core.dom.removeClassName;var d=f.core.evt.addEvent;var g=f.core.evt.removeEvent;var c=f.template.app.detail;return function(I){var G,M=[],O,A,m,R,J=[];var j=["一","二","三","四","五","六","七","八","九","十"];var l=null,v,w,p,s;var n="note_icon_success",C="note_icon_alert";var t=false;var Q=[];var F=function(){if(!I){throw"node is not defined"}};var B=function(U,S,T){var T=T||"";if(U.tagName.toLowerCase()=="body"){return null}if(U.tagName.toLowerCase()==S.toLowerCase()&&U.className.indexOf(T)>=0){return U}else{return B(U.parentNode,S,T)}};var y=function(){var T=encodeURIComponent(location.href);var U=encodeURIComponent("我发现了一个很好玩的东东#"+$CONFIG.$appName+"#，推荐给大家，快来试试看！");var S="http://service.weibo.com/share/share.php?title="+U+"&url="+T;window.open(S,"_blank")};var H=function(T){var S=T.data.url;window.open(S,"_blank")};var q=function(){p.style.overflow="hidden";var S=f.core.ani.tween(p,{end:function(){p.style.display="none"},duration:500,animationType:"easeoutcubic"});S.play({height:0,paddingTop:0,paddingBottom:0})};var E=function(){var S=f.core.dom.getSize(p);z.size=S;p.style.height="0px";p.style.overflow="hidden";p.style.display="none";p.style.padding="0px"};var D=function(){z.reset();p.style.display="block";var T={};T.index=0;P({data:T});var S=f.core.ani.tween(p,{end:function(){p.style.overflow="visible";p.style.height=""},duration:500,animationType:"easeoutcubic"});S.play({height:z.size.height-20,paddingTop:20})};var L=function(){var S=Q.length;var T;if(S>0){T=f.ui.confirm("确认删除这"+S+"项?",{OK:function(){var U=b.getTrans("removePics",{onComplete:function(V){var W=V.data;if(V.code=="100000"){location.reload()}},onFail:function(){throw"ajax request error"}});U.request({appkey:$CONFIG.$appId,ids:f.core.json.jsonToStr(Q)})}}).layer}else{T=f.ui.alert("您还没有选中任何一项······")}};var u=function(V){var U=V.data.pid;var W=V.el;var S=false;for(var T=0;T<Q.length;T++){if(Q[T]==U){S=true;break}}if(S){h(W,"delete_checked");Q.pop(U)}else{e(W,"delete_checked");Q.push(U)}};var x=function(S){var T=S.el;e(T,"img_mouseover")};var r=function(S){var T=S.el;h(T,"img_mouseover")};var z={size:null,init:function(){E();v=f.sizzle("tr",A);for(var T=0;T<v.length;T++){var U={};var S=f.sizzle("input",v[T])[0];if(!S){continue}U.input=S;U.icon=f.sizzle(".note_icon",v[T])[0];U.info=f.sizzle(".note_text_error",v[T])[0];U.input.setAttribute("index",T+"");d(U.input,"blur",z.inputBlurHandler);J.push(U)}},reset:function(){for(var S=0;S<J.length;S++){var T=J[S];T.input.value="";T.icon.style.display="none";T.info.style.display="none"}R.className="W_btn_a_disable";R.innerHTML="<span>提交</span>"},addBtnClickHandler:function(S){if(J.length>=10){return}var X=B(m,"tr");var U=null;if(v.length>0){U=v[0].cloneNode()}var W={};var T=f.sizzle("input",U)[0];var V=f.sizzle("td",U)[0];V.innerHTML="地址"+j[J.length]+"：";T.setAttribute("index",J.length);g(T,"blur",z.inputBlurHandler);d(T,"blur",z.inputBlurHandler);W.input=T;W.icon=f.sizzle(".note_icon",U)[0];W.info=f.sizzle(".note_text_error",U)[0];J.push(W);W.input.value="";W.icon.style.display="none";W.info.style.display="none";f.core.dom.insertBefore(U,X);setTimeout(function(){z.size=f.core.dom.getSize(p)},0)},inputBlurHandler:function(T){var W=T.target||T.srcElement;var U=parseInt(W.getAttribute("index"),10);var V=/weibo.com\//g;var S=V.test(J[U].input.value);if(S){J[U].icon.className="note_icon "+n;J[U].icon.style.display="";J[U].info.style.display="none"}else{J[U].icon.className="note_icon "+C;J[U].icon.style.display="";J[U].info.style.display=""}if(z.check()){R.className="W_btn_a"}else{R.className="W_btn_a_disable"}},check:function(){var S=false;for(var U=0;U<J.length;U++){var T=J[U].input;var V=/weibo.com\//g;S=S||V.test(T.value)}return S},submitClickHandler:function(){if(z.check()){if(t){return}t=true;R.className="W_btn_a";var V=[];for(var T=0;T<J.length;T++){var U=/weibo.com\//;if(U.test(J[T].input.value)){V.push(J[T].input.value)}}R.className="W_btn_a_disable";R.innerHTML='<span><i class="mark_loading"></i>提交中...</span>';var S=b.getTrans("addPics",{onComplete:function(X){var Z=X.data;t=false;if(X.code=="100000"){q();var W=f.sizzle(".fall_column_container",G.fall_gallery)[0];if(W){W.innerHTML=X.data;Q=[]}var Y=f.ui.litePrompt("提交成功!",{msg:"提交成功!"}).layer;setTimeout(function(){Y.hide()},1000)}else{if(X.code=="100001"){var Y=f.ui.litePrompt("添加失败！",{msg:"添加失败！",type:"error"}).layer;setTimeout(function(){Y.hide()},1000);R.className="W_btn_a_disable";R.innerHTML="<span>提交</span>"}}},onFail:function(W){throw"ajax request error"}});S.request({appkey:$CONFIG.$appId,data:f.core.json.jsonToStr(V)})}}};var P=function(U){var S=parseInt(U.data.index);for(var T=0;T<M.length;T++){M[T].style.display="none";h(O[T],"nav_current")}M[S].style.display="block";e(O[S],"nav_current")};var i=function(){G=f.kit.dom.parseDOM(f.builder(I).list);A=G.form_table;m=G.add_button;R=G.submit_btn;w=G.addFormBtn;p=G.edit_form;s=G.remove_btn};var o=function(){a=f.core.evt.delegatedEvent(I);a.add("tab_nav","click",P);a.add("image","mouseover",x);a.add("image","mouseout",r);a.add("remove_checkbox","click",u);a.add("mask","click",H);d(G.shareBtn,"click",y);if(A){d(w,"click",D);d(m,"click",z.addBtnClickHandler);d(R,"click",z.submitClickHandler);d(s,"click",L)}};var N=function(){if(A){z.init()}O=f.sizzle(".nav_item",I);M.push(G.fall_gallery);M.push(G.quote)};var K=function(){F();i();o();N()};K()}});STK.pageletM.register("pl.app.tabContent",function(b){var a=b.E("pl_app_tabContent");b.comp.app.tabContent(a)});STK.register("common.app.card",function(c){var b=c.kit.extra.language;var a={};return function(f,r){if(!f){throw"need node for card"}var p={};var i={attr:"app_id",tag:"a",showtime:500,delay:100};var u=c.parseParam(i,r);var d="weibo_layer_appcard",g,m,e,l,q,h=false;var t={cardInit:function(){if(g=c.E(d)){return}g=c.C("div");g.id=d;g.className="W_layer";g.style.zIndex="999";var y=c.C("td");var x=c.C("tr");x.appendChild(y);var v=c.C("tbody");v.appendChild(x);var w=c.C("table");w.border=0;w.cellspacing=0;w.cellpadding=0;w.appendChild(v);m=c.C("div");m.className="bg";e=c.C("div");e.className="content";l=c.C("div");l.className="arrow arrow_t";y.appendChild(e);m.appendChild(w);g.appendChild(m);g.appendChild(l);c.addEvent(g,"mouseover",function(){clearTimeout(q);h=true});c.addEvent(g,"mouseout",function(){h=false;q=setTimeout(function(){c.setStyle(g,"display","none")},u.delay)});c.setStyle(g,"display","none");document.body.appendChild(g)},cardPostionFix:function(x){var B=c.position(x);if(B===false){return}var A=c.pageSize();var w=c.scrollPos();var G=c.core.dom.getSize(g);var C=G.width;var z=G.height;var D="arrow arrow_t";var F=B.t;var v=B.l;var E=v+C-w.left<A.win.width;var y=F+z-w.top<A.win.height;if(y){F+=x.offsetHeight+3}if(!E){v-=C-x.offsetWidth}if(!y){F-=z+3}if(!E&&y){D="arrow arrow_t arrow_tr"}else{if(!E&&!y){D="arrow arrow_b arrow_br"}else{if(E&&!y){D="arrow arrow_b"}}}c.setStyle(g,"top",F+"px");c.setStyle(g,"left",v+"px");c.setStyle(g,"display","block");l.className=D},searchCard:function(){var y=c.core.evt.delegatedEvent(f);var x,v,w;y.add("hover","mouseover",function(z){v=z.el;x=z.data.app_id;w=z.data.ref;t.mouseOver(v,x,w)});y.add("hover","mouseout",function(z){v=z.el;x=z.data.app_id;w=z.data.ref;t.mouseOut(v,x,w)})},getCardData:function(x,w){var v=c.common.trans.app.getTrans("card",{onComplete:function(y,A){var z=y.data;if(y.code=="100001"&&y.msg!=""){z=y.msg}a[x]=a[x]||{};a[x]["card"]=z;t.getUserList(x);t.showCard(z)},onFail:function(){c.ui.alert(b("#L{请求错误}"))}});v.request({app_id:x,ref:w})},getUserList:function(w){if(a[w]["user"]){listCon&&(listCon.innerHTML=a[w]["user"])}else{var v=c.common.trans.app.getTrans("friend",{onComplete:function(x,y){if(x.code=="100000"){a[w]=a[w]||{};a[w]["user"]=x.data;t.showUser(x.data)}},onFail:function(){c.ui.alert(b("#L{请求错误}"))}});v.request({app_id:w})}},showCard:function(v){if(v){e.innerHTML=v}},showUser:function(w){var v=c.sizzle(".users_list",e)[0];if(v&&w){v.innerHTML=w}},mouseOver:function(x,w,v){clearTimeout(q);q=setTimeout(function(){t.cardPostionFix(x);t.delayShow(w,v)},u.showtime)},delayShow:function(w,v){if(a[w]){t.showCard(a[w]["card"]);t.showUser(a[w]["user"])}else{e.innerHTML='<div class="layer_app_intro W_loading_bg"></div>';t.getCardData(w,v)}},mouseOut:function(){clearTimeout(q);q=setTimeout(function(){if(g==null){return}if(!h){c.setStyle(g,"display","none")}},u.delay)}};var o=function(){};var n=function(){t.searchCard()};var j=function(){t.cardInit()};var s=function(){o();n();j()};s();p.card=t;return p}});STK.register("comp.app.appList",function(a){return function(f){var d;var c=function(){if(!f){throw"node is not defined"}};var g=function(){};var b=function(){};var e=function(){a.common.app.card(f)};var h=function(){c();g();b();e()};h()}});STK.pageletM.register("pl.app.appList",function(b){var a=b.E("pl_app_appList_1");if(a){b.comp.app.appList(a)}a=b.E("pl_app_appList_2");if(a){b.comp.app.appList(a)}});STK.register("comp.app.userlist",function(d){var c={"1":"尚未授权！","11":"推送已成功，请登陆微博Android客户端查看！","12":"重复推送，请登陆微博Android客户端查看！","13":"您的微博Android客户端版本不支持，请更新版本！"};var b=d.common.trans.app;var a=window.$CONFIG||{};return function(g){var l={};var h;var f;var j=function(){var q=b.getTrans("more",{onComplete:function(r,s){if("100000"==r.code){h.innerHTML=r.data.top}},onFail:function(){h.innerHTML=$L("#L{接口请求错误}")}});q.request({app_id:a.$appId})};var o=function(){if(!g){throw"Node has not been defined"}};var e=function(){nodes=d.kit.dom.parseDOM(d.core.dom.builder(g).list);h=nodes.userlist};var m=function(){f=d.core.evt.delegatedEvent(g);f.add("androidDownload","click",n)};var n=function(){var q=b.getTrans("android",{onComplete:function(r,s){if(r.code){d.ui.alert(r.desc||"发送成功",{icon:"success",timeout:5000})}},onFail:function(){}});q.request({appid:a.$apkid})};var i=function(){j();if($CONFIG.$autodown){n()}};var p=function(){o();e();m();i()};p()}});STK.pageletM.register("pl.app.userlist",function(c){var b=c.E("pl_app_userlist");var a=c.comp.app.userlist(b);return a});STK.pageletM.start();